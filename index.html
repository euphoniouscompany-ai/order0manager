<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì£¼ë¬¸ ê´€ë¦¬ ì‹œìŠ¤í…œ</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
        'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
        sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    // ê¸°ë³¸ê°’ (admin ì‹œíŠ¸ ë¡œë”© ì‹¤íŒ¨ ì‹œ ì‚¬ìš©)
    const DEFAULT_PRESETS = {
      "ì´í•´ìš´": {
        name: "ì´í•´ìš´",
        reviewName: "ì´*ìš´",
        phone: "010-7169-7838",
        address: "ì„œìš¸íŠ¹ë³„ì‹œ ìš©ì‚°êµ¬ íš¨ì°½ì›ë¡œ104ë‹¤ê¸¸ 6",
        coupangId: "iamandy",
        naverId: "iamandy@naver.com",
        bank: "ì‹ í•œì€í–‰",
        account: "110254150254",
        accountWithHyphen: "110254-150254"
      },
      "ì§€ì˜ì‹ ": {
        name: "ì§€ì˜ì‹ ",
        reviewName: "ì§€*ì‹ ",
        phone: "010-2771-9985",
        address: "ì¶©ì²­ë‚¨ë„ ì„œì²œêµ° ì„œë©´ ë¶€ì›ê¸¸284ë²ˆê¸¸ 12",
        coupangId: "dudtls0114",
        naverId: "dudtls00114@gmail.com",
        bank: "ì‹ í•œì€í–‰",
        account: "110254150254",
        accountWithHyphen: "110254-150254"
      },
      "ì •ë™ì‹ ": {
        name: "ì •ë™ì‹ ",
        reviewName: "ì •*ì‹ ",
        phone: "010-9083-9985",
        address: "ê²½ê¸°ë„ ê³ ì–‘ì‹œ ì¼ì‚°ì„œêµ¬ íƒ„í˜„ë¡œ 136 116ë™ 703í˜¸",
        coupangId: "wjdehdtls",
        naverId: "wjdehdtls@naver.com",
        bank: "ì‹ í•œì€í–‰",
        account: "110254150254",
        accountWithHyphen: "110254-150254"
      },
      "ì „ë™ì—´": {
        name: "ì „ë™ì—´",
        reviewName: "ì „*ì—´",
        phone: "010-8019-4657",
        address: "ì„œìš¸íŠ¹ë³„ì‹œ ë§ˆí¬êµ¬ í† ì •ë¡œ 223-1",
        coupangId: "dmi2286",
        naverId: "iamandy11@gmail.com",
        bank: "ì‹ í•œì€í–‰",
        account: "110254150254",
        accountWithHyphen: "110254-150254"
      },
      "ì¥ìƒ›ë³„": {
        name: "ì¥ìƒ›ë³„",
        reviewName: "ì¥*ë³„",
        phone: "010-2124-7160",
        address: "ì„œìš¸íŠ¹ë³„ì‹œ ë§ˆí¬êµ¬ í† ì •ë¡œ 223-1",
        coupangId: "zzang9227",
        naverId: "zzang9227@naver.com",
        bank: "ì‹ í•œì€í–‰",
        account: "110254150254",
        accountWithHyphen: "110254-150254"
      },
      "ì´í•´ë¦¼": {
        name: "ì´í•´ë¦¼",
        reviewName: "ì´*ë¦¼",
        phone: "010-2017-9985",
        address: "ê²½ê¸°ë„ ê³ ì–‘ì‹œ ì¼ì‚°ì„œêµ¬ íƒ„í˜„ë¡œ 136 116ë™ 703í˜¸",
        coupangId: "pitosungy",
        naverId: "pitosungy@naver.com",
        bank: "ì‹ í•œì€í–‰",
        account: "110254150254",
        accountWithHyphen: "110254-150254"
      }
    };

    const DEFAULT_SITES = [
      "ì¿ íŒ¡", "ë„¤ì´ë²„", "ì¹´ì¹´ì˜¤í†¡ì‡¼í•‘", "ìš¸ë¦¼ë‹¬ì˜", "ì˜¤ëŠ˜ì˜ì§‘", "ì˜¥ì…˜",
      "GSSHOP", "SSG", "ë¬´ì‹ ì‚¬", "í¬ëª½", "11ë²ˆê°€", "ë¡¯ë°ì˜¨", "ì§€ë§ˆì¼“", "ì§ì ‘ì…ë ¥"
    ];

    const DEFAULT_IDS = [
      "iamandy", "dudtls", "wjdehdtls", "iamandy11", 
      "ë³„ì´", "haewoon1", "dmi2286", "pitosung"
    ];

    const DEFAULT_CARDS = [
      "ì™€ìš°", "ë„¤í˜„", "íŠ¸ë ˆë¸”",
      "ì‹ -ì¿ ", "ê¸ˆ-ì¿ ", "ì‹ -ë„¤", "ê¸ˆ-ë„¤",
      "ì‹ -ì•±", "ê¸ˆ-ì•±", "ì‹ -ìŠ¤", "ê¸ˆ-ìŠ¤", "ì‹ -í† ", "ê¸ˆ-í† ",
      "ì¹´ì‹ -ì¿ ", "ì¹´ì‹ -ë„¤", "ì¹´ì‹ -ì•±", "ì¹´ì‹ -ì¹´", "ì¹´ì‹ -í† ", "ì¹´ì‹ -ìŠ¤"
    ];

    const DEFAULT_DELIVERY_TYPES = ["ì‹¤ë°°", "ë¹ˆ", "íšŒìˆ˜"];
    const DEFAULT_REVIEW_METHODS = ["í¬í† ", "í…ìŠ¤íŠ¸", "ë³„", "êµ¬í™•"];
    const DEFAULT_REVIEW_FEES = ["0", "500", "1000", "1500", "ì§ì ‘ì…ë ¥"];

    const OrderManager = () => {
      // ë™ì  ì„¤ì • (review-setting ì‹œíŠ¸ì—ì„œ ë¡œë“œ)
      const [PRESETS, setPRESETS] = useState(DEFAULT_PRESETS);
      const [SITES, setSITES] = useState(DEFAULT_SITES);
      const [IDS, setIDS] = useState(DEFAULT_IDS);
      const [SITE_IDS, setSITE_IDS] = useState({}); // ì‚¬ì´íŠ¸ë³„ ì•„ì´ë””
      const [CARDS, setCARDS] = useState(DEFAULT_CARDS);
      const [DELIVERY_TYPES, setDELIVERY_TYPES] = useState(DEFAULT_DELIVERY_TYPES);
      const [REVIEW_METHODS, setREVIEW_METHODS] = useState(DEFAULT_REVIEW_METHODS);
      const [REVIEW_FEES, setREVIEW_FEES] = useState(DEFAULT_REVIEW_FEES);

      // ë¡œë”© ìƒíƒœ
      const [loading, setLoading] = useState(true);
      const [configError, setConfigError] = useState('');

      // review-setting ì‹œíŠ¸ì—ì„œ ì„¤ì • ë¡œë“œ
      useEffect(() => {
        // ê¸°ë³¸ê°’ìœ¼ë¡œ ë°”ë¡œ ì‹œì‘ (Apps Script ë¡œë”© ìŠ¤í‚µ)
        setLoading(false);
        
        // ë°±ê·¸ë¼ìš´ë“œì—ì„œ ë¡œë“œ ì‹œë„ (ì‹¤íŒ¨í•´ë„ ë¬´ì‹œ)
        loadConfigFromSheet();
      }, []);

      const loadConfigFromSheet = async () => {
        // ì¼ë‹¨ ê¸°ë³¸ê°’ìœ¼ë¡œ ë°”ë¡œ ì‹œì‘
        setLoading(false);
        
        // ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹œíŠ¸ ë¡œë”© ì‹œë„
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwgzP-H1Gih90FzF-hncsrXWf18LzFvmPA1CA3j7d8A7z_HDGuCQslJv_QKcGIJh_Cy/exec';
        
        if (APPS_SCRIPT_URL === 'YOUR_APPS_SCRIPT_URL_HERE') {
          setConfigError('âš ï¸ Apps Script URLì„ ì„¤ì •í•´ì£¼ì„¸ìš”');
          return;
        }

        try {
          // JSONP ë°©ì‹ìœ¼ë¡œ CORS ìš°íšŒ
          const callbackName = 'jsonpCallback_' + Date.now();
          
          await new Promise((resolve, reject) => {
            const timeout = setTimeout(() => {
              reject(new Error('Timeout'));
            }, 3000);
            
            window[callbackName] = (data) => {
              clearTimeout(timeout);
              delete window[callbackName];
              
              if (data.success && data.config) {
                const config = data.config;
                
                // ì‚¬ëŒ ì •ë³´ ë³€í™˜
                if (config.people && config.people.length > 0) {
                  const newPresets = {};
                  config.people.forEach(person => {
                    newPresets[person.name] = {
                      name: person.name,
                      reviewName: person.name.charAt(0) + '*' + person.name.charAt(person.name.length - 1),
                      phone: person.phone,
                      address: person.address,
                      coupangId: person.coupangId,
                      naverId: person.naverId,
                      bank: "ì‹ í•œì€í–‰",
                      account: "110254150254",
                      accountWithHyphen: "110254-150254"
                    };
                  });
                  setPRESETS(newPresets);
                  
                  const ids = config.people.map(p => p.coupangId).filter(Boolean);
                  if (ids.length > 0) setIDS(ids);
                }
                
                if (config.sites && config.sites.length > 0) setSITES(config.sites);
                if (config.siteIds) {
                  setSITE_IDS(config.siteIds);
                  console.log('âœ… ì‚¬ì´íŠ¸ë³„ ì•„ì´ë”” ë¡œë“œë¨:', config.siteIds);
                }
                if (config.cards && config.cards.length > 0) setCARDS(config.cards);
                if (config.deliveryTypes && config.deliveryTypes.length > 0) setDELIVERY_TYPES(config.deliveryTypes);
                if (config.reviewMethods && config.reviewMethods.length > 0) setREVIEW_METHODS(config.reviewMethods);
                if (config.reviewFees && config.reviewFees.length > 0) setREVIEW_FEES(config.reviewFees.map(String));
                
                if (config.labelMappings && Object.keys(config.labelMappings).length > 0) {
                  setLearnedMappings(config.labelMappings);
                  console.log('âœ… ë¼ë²¨ í•™ìŠµ ë°ì´í„° ë¡œë“œë¨:', config.labelMappings);
                }
                
                setConfigError(''); // ì—ëŸ¬ ë©”ì‹œì§€ ì œê±°
                resolve();
              } else {
                reject(new Error(data.error || 'ì„¤ì •ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤'));
              }
            };
            
            const script = document.createElement('script');
            script.src = APPS_SCRIPT_URL + '?action=getConfig&callback=' + callbackName;
            script.onerror = () => {
              clearTimeout(timeout);
              reject(new Error('Script load failed'));
            };
            document.body.appendChild(script);
            
            setTimeout(() => {
              if (document.body.contains(script)) {
                document.body.removeChild(script);
              }
            }, 5000);
          });
          
        } catch (error) {
          console.log('ì„¤ì • ë¡œë”© ì‹¤íŒ¨ (ê¸°ë³¸ê°’ ì‚¬ìš©):', error);
          // ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ ì•ˆ í•¨
        }
      };

    // ë²”ìš© íŒŒì‹± í•¨ìˆ˜
    const parseOrderText = (text) => {
      const result = {
        site: '',
        orderNumber: '',
        price: '',
        receiver: '',
        phone: '',
        address: '',
        detected: false
      };

      // ì‚¬ì´íŠ¸ ê°ì§€ (ë‹¤ì–‘í•œ í‚¤ì›Œë“œ)
      const siteKeywords = {
        "ì¿ íŒ¡": ["ì¿ íŒ¡", "coupang"],
        "ë„¤ì´ë²„": ["ë„¤ì´ë²„í˜ì´", "ë„¤ì´ë²„íŒŒì´ë‚¸ì…œ", "ë„¤ì´ë²„"],
        "ì˜¥ì…˜": ["ì˜¥ì…˜", "auction", "eBay"],
        "ì§€ë§ˆì¼“": ["ì§€ë§ˆì¼“", "Gë§ˆì¼“", "gmarket"],
        "11ë²ˆê°€": ["11ë²ˆê°€", "11st"],
        "SSG": ["SSG", "ì‹ ì„¸ê³„"],
        "ë¬´ì‹ ì‚¬": ["ë¬´ì‹ ì‚¬", "musinsa"],
        "ì¿ íŒ¡": ["MYì¿ íŒ¡", "ë§ˆì´ì¿ íŒ¡"]
      };

      for (const [site, keywords] of Object.entries(siteKeywords)) {
        if (keywords.some(kw => text.includes(kw))) {
          result.site = site;
          break;
        }
      }

      // ì£¼ë¬¸ë²ˆí˜¸ ì¶”ì¶œ (ë‹¤ì–‘í•œ íŒ¨í„´)
      const orderPatterns = [
        /ì£¼ë¬¸\s*ë²ˆí˜¸[:\s]*(\d{10,})/i,
        /order[:\s]*(?:no|number)[:\s]*(\d{10,})/i,
        /ë²ˆí˜¸[:\s]*(\d{10,})/i,
        /(\d{13,20})/  // 13-20ìë¦¬ ìˆ«ì
      ];

      for (const pattern of orderPatterns) {
        const match = text.match(pattern);
        if (match && match[1]) {
          result.orderNumber = match[1];
          break;
        }
      }

      // ê¸ˆì•¡ ì¶”ì¶œ
      const pricePatterns = [
        // ë„¤ì´ë²„í˜ì´ ìš°ì„ : ì¹´ë“œ ê°„í¸ê²°ì œ / ì‹ ìš©ì¹´ë“œ ë’¤ì˜ ê¸ˆì•¡
        /(?:ì¹´ë“œ\s*ê°„í¸ê²°ì œ|ì‹ ìš©ì¹´ë“œ|ì²´í¬ì¹´ë“œ)\s*\n\s*(\d{1,3}(?:,\d{3})*)\s*ì›/i,
        /(?:ì¹´ë“œ\s*ê°„í¸ê²°ì œ|ì‹ ìš©ì¹´ë“œ|ì²´í¬ì¹´ë“œ)[^\d]*(\d{1,3}(?:,\d{3})*)\s*ì›/i,
        
        // ê³„ì¢Œì´ì²´
        /(?:ê³„ì¢Œì´ì²´|ë¬´í†µì¥ì…ê¸ˆ)\s*\n\s*(\d{1,3}(?:,\d{3})*)\s*ì›/i,
        
        // ë„¤ì´ë²„í˜ì´: ì£¼ë¬¸ê¸ˆì•¡ ì„¹ì…˜
        /ì£¼ë¬¸ê¸ˆì•¡[^\d]*ì´\s*(\d{1,3}(?:,\d{3})*)\s*ì›/i,
        
        // ì¼ë°˜ íŒ¨í„´
        /ì´\s*ê²°ì œ\s*ê¸ˆì•¡[:\s]*(\d{1,3}(?:,\d{3})*)\s*ì›/i,
        /ìµœì¢…\s*ê²°ì œ\s*ê¸ˆì•¡[:\s]*(\d{1,3}(?:,\d{3})*)/i,
        /total[:\s]*(\d{1,3}(?:,\d{3})*)/i,
        /ê²°ì œ\s*ê¸ˆì•¡[:\s]*(\d{1,3}(?:,\d{3})*)/i
      ];

      for (const pattern of pricePatterns) {
        const match = text.match(pattern);
        if (match && match[1]) {
          result.price = match[1].replace(/,/g, '');
          break;
        }
      }

      // ìˆ˜ì·¨ì¸ ì¶”ì¶œ
      const receiverPatterns = [
        /ë°›ëŠ”\s*ì‚¬ëŒ[:\s]*([^\s\t]+)/i,
        /ìˆ˜ë ¹ì[:\s]*([^\s\t]+)/i,
        /ë°›ìœ¼ì‹œëŠ”\s*ë¶„[:\s]*([^\s\t]+)/i,
        /ë°°ì†¡ì§€ëª…[^\(]*\(([^\)]+)\)/i
      ];

      for (const pattern of receiverPatterns) {
        const match = text.match(pattern);
        if (match && match[1]) {
          result.receiver = match[1].trim();
          break;
        }
      }

      // ì „í™”ë²ˆí˜¸ ì¶”ì¶œ
      const phoneMatch = text.match(/(010[-\s]?\d{4}[-\s]?\d{4})/);
      if (phoneMatch) {
        result.phone = phoneMatch[1].replace(/\s/g, '').replace(/(\d{3})(\d{4})(\d{4})/, '$1-$2-$3');
      }

      // ì£¼ì†Œ ì¶”ì¶œ (ìš°í¸ë²ˆí˜¸ ìˆëŠ” ì£¼ì†Œ)
      const addressPatterns = [
        /\((\d{5})\)\s*([^\n]+)/,
        /\[(\d{5})\]\s*([^\n]+)/,
        /ì£¼ì†Œ[:\s]*\(?\d{5}\)?\s*([^\n]+)/i,
        /ë°›ëŠ”\s*ì£¼ì†Œ[:\s]*([^\n]+)/i
      ];

      for (const pattern of addressPatterns) {
        const match = text.match(pattern);
        if (match) {
          result.address = match[match.length - 1].trim();
          break;
        }
      }

      result.detected = !!(result.orderNumber || result.price);
      
      return result;
    };

      const [orders, setOrders] = useState([
        { 
          id: Date.now(), 
          rawText: '',
          site: '',
          orderNumber: '',
          price: '',
          person: Object.keys(PRESETS)[0],
          personId: PRESETS[Object.keys(PRESETS)[0]].coupangId,
          card: CARDS[0],
          deliveryType: 'ì‹¤ë°°',
          reviewMethod: 'í¬í† ',
          reviewFee: '1000',
          guideline: '',
          productUrl: '',
          parsed: false
        }
      ]);

      const [commonSettings, setCommonSettings] = useState({
        talkRoomName: '',
        transactionDate: new Date().toISOString().split('T')[0], // ì˜¤ëŠ˜ ë‚ ì§œ (YYYY-MM-DD)
        deliveryType: 'ì‹¤ë°°',
        reviewMethod: 'í¬í† ',
        reviewFee: '1000',
        guideline: ''
      });

      const addOrder = () => {
        setOrders([...orders, {
          id: Date.now(),
          rawText: '',
          site: '',
          orderNumber: '',
          price: '',
          person: Object.keys(PRESETS)[orders.length % 6],
          personId: PRESETS[Object.keys(PRESETS)[orders.length % 6]].coupangId,
          card: CARDS[0],
          deliveryType: 'ì‹¤ë°°',
          reviewMethod: 'í¬í† ',
          reviewFee: '1000',
          guideline: '',
          productUrl: '',
          parsed: false
        }]);
      };

      const removeOrder = (id) => {
        if (orders.length > 1) {
          setOrders(orders.filter(o => o.id !== id));
        }
      };

      const handlePaste = (index, text) => {
        const parsed = parseOrderText(text);
        const newOrders = [...orders];
        newOrders[index] = {
          ...newOrders[index],
          rawText: text,
          site: parsed.site || newOrders[index].site,
          orderNumber: parsed.orderNumber || newOrders[index].orderNumber,
          price: parsed.price || newOrders[index].price,
          parsed: parsed.detected
        };
        setOrders(newOrders);
      };

      const updateOrder = (index, field, value) => {
        const newOrders = [...orders];
        newOrders[index][field] = value;
        if (field === 'person') {
          newOrders[index].personId = PRESETS[value].coupangId;
        }
        setOrders(newOrders);
      };

      const applyCommonSettings = () => {
        setOrders(orders.map(order => {
          const updatedOrder = {
            ...order,
            deliveryType: commonSettings.deliveryType,
            reviewMethod: commonSettings.reviewMethod,
            reviewFee: commonSettings.reviewFee,
            guideline: commonSettings.guideline
          };
          
          // ì£¼ë¬¸ì ì¼ê´„ ì ìš© (ì„ íƒëœ ê²½ìš°)
          if (commonSettings.person) {
            updatedOrder.person = commonSettings.person;
            updatedOrder.personId = PRESETS[commonSettings.person].coupangId;
          }
          
          // ë¦½ë¹„ ì§ì ‘ì…ë ¥ ê°’ ì ìš©
          if (commonSettings.reviewFee === 'ì§ì ‘ì…ë ¥' && commonSettings.customReviewFee) {
            updatedOrder.customFee = commonSettings.customReviewFee;
          }
          
          return updatedOrder;
        }));
        
        alert('âœ… ê³µí†µ ì„¤ì •ì´ ëª¨ë“  ì£¼ë¬¸ì— ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤!');
      };

      const resetAllOrders = () => {
        if (confirm('ğŸ—‘ï¸ ëª¨ë“  ì£¼ë¬¸ì„ ì‚­ì œí•˜ê³  ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
          setOrders([{
            id: Date.now(),
            rawText: '',
            site: '',
            orderNumber: '',
            price: '',
            person: Object.keys(PRESETS)[0],
            personId: PRESETS[Object.keys(PRESETS)[0]].coupangId,
            card: CARDS[0],
            deliveryType: 'ì‹¤ë°°',
            reviewMethod: 'í¬í† ',
            reviewFee: '1000',
            guideline: '',
            productUrl: '',
            parsed: false
          }]);
          setCommonSettings({
            talkRoomName: '',
            transactionDate: new Date().toISOString().split('T')[0],
            deliveryType: 'ì‹¤ë°°',
            reviewMethod: 'í¬í† ',
            reviewFee: '1000',
            guideline: ''
          });
          alert('âœ… ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }
      };

      // ì¶œë ¥ ì„¤ì • state
      const [formTemplate, setFormTemplate] = useState('');
      const [removeLabels, setRemoveLabels] = useState(false);
      const [selectedOrders, setSelectedOrders] = useState([]);
      const [outputData, setOutputData] = useState({});
      const [editableData, setEditableData] = useState({}); // í¸ì§‘ ê°€ëŠ¥í•œ ë°ì´í„°

      // ì£¼ë¬¸ ì„ íƒ ì‹œ í¸ì§‘ ë°ì´í„° ì´ˆê¸°í™”
      useEffect(() => {
        const fields = parseFormTemplate(formTemplate);
        const newEditableData = {};
        
        selectedOrders.forEach(orderIndex => {
          const order = orders[orderIndex];
          if (!order) return;
          
          const preset = PRESETS[order.person];
          const site = order.site === 'ì§ì ‘ì…ë ¥' ? (order.customSite || '') : order.site;
          const personId = order.personId === 'ì§ì ‘ì…ë ¥' ? (order.customId || '') : order.personId;
          const reviewFee = order.reviewFee === 'ì§ì ‘ì…ë ¥' ? (order.customFee || '') : order.reviewFee;
          
          newEditableData[orderIndex] = {
            name: preset.name,
            orderNumber: order.orderNumber,
            personId: personId,
            naverId: preset.naverId,
            phone: preset.phone,
            phoneNoHyphen: preset.phone.replace(/-/g, ''),
            address: preset.address,
            price: order.price,
            site: site,
            card: order.card,
            deliveryType: order.deliveryType,
            reviewMethod: order.reviewMethod,
            reviewFee: reviewFee,
            bank: preset.bank,
            account: preset.account,
            accountWithHyphen: preset.accountWithHyphen,
            receiver: preset.name
          };
        });
        
        setEditableData(newEditableData);
      }, [selectedOrders, formTemplate, orders]);

      // í¸ì§‘ ë°ì´í„° ì—…ë°ì´íŠ¸
      const updateEditableData = (orderIndex, field, value) => {
        setEditableData({
          ...editableData,
          [orderIndex]: {
            ...editableData[orderIndex],
            [field]: value
          }
        });
      };

      // í¼ ì–‘ì‹ íŒŒì‹±
      const parseFormTemplate = (template) => {
        const lines = template.split('\n').filter(l => l.trim());
        const fields = [];
        
        lines.forEach(line => {
          // "ì´ë¦„:", "ì£¼ë¬¸ë²ˆí˜¸:" ê°™ì€ ë¼ë²¨ ì¶”ì¶œ
          const match = line.match(/^([^:ï¼š/]+)[:\ï¼š]?\s*$/);
          if (match) {
            fields.push(match[1].trim());
          }
          // "ì´ë¦„ / ì „í™”ë²ˆí˜¸" ê°™ì€ ìŠ¬ë˜ì‹œ êµ¬ë¶„
          else if (line.includes('/')) {
            const parts = line.split('/').map(p => p.trim());
            fields.push(...parts);
          }
        });
        
        return fields;
      };

      // í•„ë“œëª…ì„ ë°ì´í„° í‚¤ë¡œ ë§¤í•‘
      const [learnedMappings, setLearnedMappings] = useState(() => {
        const saved = localStorage.getItem('learnedMappings');
        return saved ? JSON.parse(saved) : {};
      });

      const mapFieldToKey = (fieldName) => {
        // ë¨¼ì € í•™ìŠµëœ ë§¤í•‘ í™•ì¸
        if (learnedMappings[fieldName]) {
          return learnedMappings[fieldName];
        }
        
        const mappings = {
          'ì´ë¦„': 'name',
          'ì„±ëª…': 'name',
          'êµ¬ë§¤ì': 'name',
          'ì„±í•¨': 'name',
          'ìˆ˜ì·¨ì¸': 'receiver',
          'ë°›ëŠ”ë¶„': 'receiver',
          'ë°›ëŠ”ì‚¬ëŒ': 'receiver',
          'ì£¼ë¬¸ë²ˆí˜¸': 'orderNumber',
          'ë²ˆí˜¸': 'orderNumber',
          'ì•„ì´ë””': 'personId',
          'ID': 'personId',
          'ì´ë©”ì¼': 'naverId',
          'ì „í™”ë²ˆí˜¸': 'phone',
          'ì—°ë½ì²˜': 'phone',
          'í•¸ë“œí°': 'phone',
          'ì£¼ì†Œ': 'address',
          'ë°°ì†¡ì§€': 'address',
          'ê¸ˆì•¡': 'price',
          'ê°€ê²©': 'price',
          'ê²°ì œê¸ˆì•¡': 'price',
          'ì‚¬ì´íŠ¸': 'site',
          'ì±„ë„': 'site',
          'êµ¬ë§¤ì±„ë„': 'site',
          'ì¹´ë“œ': 'card',
          'ë°°ì†¡': 'deliveryType',
          'ë¦¬ë·°': 'reviewMethod',
          'ë¦½ë¹„': 'reviewFee',
          'ì€í–‰': 'bank',
          'ì€í–‰ëª…': 'bank',
          'ê³„ì¢Œ': 'accountWithHyphen',
          'ê³„ì¢Œë²ˆí˜¸': 'accountWithHyphen',
          'ì€í–‰ ê³„ì¢Œë²ˆí˜¸': 'accountWithHyphen',
          'ì˜ˆê¸ˆì£¼': 'name',
          'êµ¬ì… ê¸ˆì•¡': 'price',
          'êµ¬ì…ê¸ˆì•¡': 'price'
        };
        
        return mappings[fieldName] || fieldName;
      };

      // ë¼ë²¨ í•™ìŠµ ì €ì¥
      const saveLearnedMapping = (label, key) => {
        const newMappings = {
          ...learnedMappings,
          [label]: key
        };
        setLearnedMappings(newMappings);
        localStorage.setItem('learnedMappings', JSON.stringify(newMappings));
        alert(`âœ… "${label}" â†’ "${key}" ë§¤í•‘ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!`);
      };

      // ì£¼ë¬¸ ì„ íƒ í† ê¸€
      const toggleOrderSelection = (index) => {
        if (selectedOrders.includes(index)) {
          setSelectedOrders(selectedOrders.filter(i => i !== index));
        } else {
          setSelectedOrders([...selectedOrders, index]);
        }
      };

      // ì¶œë ¥ ë°ì´í„° ìƒì„±
      const generateOutputText = () => {
        if (!formTemplate.trim()) {
          alert('âš ï¸ í¼ ì–‘ì‹ì„ ì…ë ¥í•´ì£¼ì„¸ìš”');
          return '';
        }
        
        if (selectedOrders.length === 0) {
          alert('âš ï¸ ì¶œë ¥í•  ì£¼ë¬¸ì„ ì„ íƒí•´ì£¼ì„¸ìš”');
          return '';
        }
        
        return selectedOrders.map(orderIndex => {
          const data = editableData[orderIndex];
          if (!data) return '';
          
          const lines = formTemplate.split('\n').filter(l => l.trim());
          
          return lines.map(line => {
            // ìŠ¬ë˜ì‹œ í˜•ì‹ ì²´í¬
            if (line.includes('/')) {
              const parts = line.split('/');
              const values = parts.map(part => {
                const fieldName = part.trim();
                const key = mapFieldToKey(fieldName);
                return data[key] || '';
              });
              
              // ìŠ¬ë˜ì‹œ ì•ë’¤ ê³µë°± ìœ ì§€
              const separator = line.match(/\s*\/\s*/)?.[0] || '/';
              
              if (removeLabels) {
                return values.join(separator);
              } else {
                return parts.map((part, i) => `${part.trim()}: ${values[i]}`).join(separator);
              }
            }
            // ì¼ë°˜ ë¼ë²¨ í˜•ì‹
            else {
              const match = line.match(/^([^:ï¼š]+)[:\ï¼š]?\s*$/);
              if (match) {
                const fieldName = match[1].trim();
                const key = mapFieldToKey(fieldName);
                const value = data[key] || '';
                
                if (removeLabels) {
                  return value;
                } else {
                  return `${fieldName}: ${value}`;
                }
              }
            }
            return '';
          }).filter(Boolean).join('\n');
        }).filter(Boolean).join('\n\n---\n\n');
      };

      const copyOutputToClipboard = () => {
        const text = generateOutputText();
        if (text) {
          navigator.clipboard.writeText(text);
          alert(`âœ… ${selectedOrders.length}ê°œ ì£¼ë¬¸ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!`);
        }
      };

      const [outputSettings, setOutputSettings] = useState({
        format: 'form',
        customTemplate: '',
        separator: '/',
        phoneFormat: 'hyphen', // 'hyphen' or 'none'
        accountFormat: 'hyphen' // 'hyphen' or 'none'
      });

      const [savedPresets, setSavedPresets] = useState(() => {
        const saved = localStorage.getItem('outputPresets');
        return saved ? JSON.parse(saved) : {
          "ê¸°ë³¸": {
            separator: '/',
            phoneFormat: 'hyphen',
            accountFormat: 'hyphen',
            customTemplate: ''
          }
        };
      });

      const [presetName, setPresetName] = useState('');
      const [showPresetDialog, setShowPresetDialog] = useState(false);

      const savePreset = () => {
        if (!presetName.trim()) {
          alert('âš ï¸ í”„ë¦¬ì…‹ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”');
          return;
        }
        
        const newPresets = {
          ...savedPresets,
          [presetName]: {
            separator: outputSettings.separator,
            phoneFormat: outputSettings.phoneFormat,
            accountFormat: outputSettings.accountFormat,
            customTemplate: outputSettings.customTemplate
          }
        };
        
        setSavedPresets(newPresets);
        localStorage.setItem('outputPresets', JSON.stringify(newPresets));
        setPresetName('');
        setShowPresetDialog(false);
        alert(`âœ… "${presetName}" í”„ë¦¬ì…‹ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!`);
      };

      const loadPreset = (name) => {
        const preset = savedPresets[name];
        if (preset) {
          setOutputSettings({
            ...outputSettings,
            separator: preset.separator,
            phoneFormat: preset.phoneFormat,
            accountFormat: preset.accountFormat,
            customTemplate: preset.customTemplate
          });
          alert(`âœ… "${name}" í”„ë¦¬ì…‹ì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤!`);
        }
      };

      const deletePreset = (name) => {
        if (name === 'ê¸°ë³¸') {
          alert('âš ï¸ ê¸°ë³¸ í”„ë¦¬ì…‹ì€ ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
          return;
        }
        
        if (confirm(`"${name}" í”„ë¦¬ì…‹ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
          const newPresets = {...savedPresets};
          delete newPresets[name];
          setSavedPresets(newPresets);
          localStorage.setItem('outputPresets', JSON.stringify(newPresets));
          alert(`âœ… "${name}" í”„ë¦¬ì…‹ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤`);
        }
      };

      const generateOutput = (format = 'form', customTemplate = '') => {
        return orders.filter(o => o.orderNumber && o.price).map(order => {
          const preset = PRESETS[order.person];
          
          // ì§ì ‘ì…ë ¥ ê°’ ì²˜ë¦¬
          const site = order.site === 'ì§ì ‘ì…ë ¥' ? (order.customSite || 'ì§ì ‘ì…ë ¥') : order.site;
          const personId = order.personId === 'ì§ì ‘ì…ë ¥' ? (order.customId || 'ì§ì ‘ì…ë ¥') : order.personId;
          const reviewFee = order.reviewFee === 'ì§ì ‘ì…ë ¥' ? (order.customFee || 'ì§ì ‘ì…ë ¥') : order.reviewFee;
          
          // ì „í™”ë²ˆí˜¸ í¬ë§·
          const phone = outputSettings.phoneFormat === 'none' 
            ? preset.phone.replace(/-/g, '') 
            : preset.phone;
          
          // ê³„ì¢Œë²ˆí˜¸ í¬ë§·  
          const account = outputSettings.accountFormat === 'none'
            ? preset.account
            : preset.accountWithHyphen;
          
          if (format === 'slash') {
            const sep = ` ${outputSettings.separator} `;
            return `${preset.name}${sep}${preset.name}${sep}${personId}${sep}${phone}${sep}${preset.address}${sep}${preset.bank}${sep}${account}${sep}${preset.name}${sep}${order.price}`;
          } else if (format === 'form') {
            return `êµ¬ì… ì±„ë„: ${site}
ì•„ì´ë””: ${personId}
ì£¼ë¬¸ë²ˆí˜¸: ${order.orderNumber}
êµ¬ë§¤ìëª…: ${preset.name}
ìˆ˜ì·¨ì¸ëª…: ${preset.name}
ì£¼ì†Œ: ${preset.address}
ì—°ë½ì²˜(-í¬í•¨): ${phone}
ì€í–‰ëª…: ${preset.bank}
ì€í–‰ ê³„ì¢Œë²ˆí˜¸(í•˜ì´í”ˆì‚­ì œ -): ${preset.account}
ì€í–‰ ì˜ˆê¸ˆì£¼: ${preset.name}
ê²°ì œ ê¸ˆì•¡: ${order.price}`;
          } else if (format === 'custom' && customTemplate) {
            // ì»¤ìŠ¤í…€ í…œí”Œë¦¿ ì‚¬ìš©
            return customTemplate
              .replace(/{site}/g, site)
              .replace(/{id}/g, personId)
              .replace(/{orderNumber}/g, order.orderNumber)
              .replace(/{name}/g, preset.name)
              .replace(/{receiver}/g, preset.name)
              .replace(/{phone}/g, phone)
              .replace(/{address}/g, preset.address)
              .replace(/{bank}/g, preset.bank)
              .replace(/{account}/g, account)
              .replace(/{accountHolder}/g, preset.name)
              .replace(/{price}/g, order.price)
              .replace(/{card}/g, order.card)
              .replace(/{delivery}/g, order.deliveryType)
              .replace(/{review}/g, order.reviewMethod)
              .replace(/{reviewFee}/g, reviewFee);
          } else {
            // ê°’ë§Œ
            return `${site}
${personId}
${order.orderNumber}
${preset.name}
${preset.name}
${preset.address}
${phone}
${preset.bank}
${preset.account}
${preset.name}
${order.price}`;
          }
        }).join('\n\n---\n\n');
      };

      const copyToClipboard = (format) => {
        const text = generateOutput(format, outputSettings.customTemplate);
        if (!text) {
          alert('âš ï¸ ë³µì‚¬í•  ì£¼ë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.\nì£¼ë¬¸ë²ˆí˜¸ì™€ ê¸ˆì•¡ì´ ìˆëŠ” ì£¼ë¬¸ë§Œ ë³µì‚¬ë©ë‹ˆë‹¤.');
          return;
        }
        navigator.clipboard.writeText(text);
        alert(`âœ… ${orders.filter(o => o.orderNumber && o.price).length}ê°œ ì£¼ë¬¸ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!`);
      };

      const saveToGoogleSheets = async () => {
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwgzP-H1Gih90FzF-hncsrXWf18LzFvmPA1CA3j7d8A7z_HDGuCQslJv_QKcGIJh_Cy/exec';
        
        if (APPS_SCRIPT_URL === 'YOUR_APPS_SCRIPT_URL_HERE') {
          alert('âš ï¸ Apps Script URLì„ ì„¤ì •í•´ì£¼ì„¸ìš”!\n\níŒŒì¼ì„ í…ìŠ¤íŠ¸ ì—ë””í„°ë¡œ ì—´ì–´ì„œ\nYOUR_APPS_SCRIPT_URL_HEREë¥¼\nì‹¤ì œ URLë¡œ êµì²´í•˜ì„¸ìš”.');
          return;
        }

        const sheetsData = orders.filter(o => o.orderNumber && o.price).map(order => {
          // ê³µí†µ ì„¤ì •ì—ì„œ ì„ íƒí•œ ë‚ ì§œ ì‚¬ìš©
          const selectedDate = new Date(commonSettings.transactionDate);
          const dateStr = `${selectedDate.getFullYear()}. ${selectedDate.getMonth() + 1}. ${selectedDate.getDate()}`;
          
          // ì§ì ‘ì…ë ¥ ê°’ ì²˜ë¦¬
          const site = order.site === 'ì§ì ‘ì…ë ¥' ? (order.customSite || 'ì§ì ‘ì…ë ¥') : order.site;
          const personId = order.personId === 'ì§ì ‘ì…ë ¥' ? (order.customId || 'ì§ì ‘ì…ë ¥') : order.personId;
          const reviewFee = order.reviewFee === 'ì§ì ‘ì…ë ¥' ? (order.customFee || 'ì§ì ‘ì…ë ¥') : order.reviewFee;
          
          return {
            date: dateStr,
            site: site,
            talkRoom: commonSettings.talkRoomName,
            id: personId,
            price: order.price,
            card: order.card,
            delivery: order.deliveryType,
            review: order.reviewMethod,
            reviewFee: reviewFee,
            guideline: order.guideline,
            orderNumber: order.orderNumber,
            productUrl: order.productUrl || ''
          };
        });

        if (sheetsData.length === 0) {
          alert('âš ï¸ ì €ì¥í•  ì£¼ë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.\nì£¼ë¬¸ë²ˆí˜¸ì™€ ê¸ˆì•¡ì´ ìˆëŠ” ì£¼ë¬¸ë§Œ ì €ì¥ë©ë‹ˆë‹¤.');
          return;
        }

        try {
          await fetch(APPS_SCRIPT_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ orders: sheetsData }),
            mode: 'no-cors'
          });
          
          alert(`âœ… ${sheetsData.length}ê°œ ì£¼ë¬¸ì´ êµ¬ê¸€ ì‹œíŠ¸ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!`);
          
        } catch (error) {
          console.error('ì €ì¥ ì˜¤ë¥˜:', error);
          alert('âŒ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n\n' + error.message);
        }
      };

      // ë¡œë”© ì¤‘ì´ë©´ ë¡œë”© í™”ë©´ í‘œì‹œ
      if (loading) {
        return React.createElement('div', {
          style: {
            minHeight: '100vh',
            background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
            display: 'flex',
            justifyContent: 'center',
            alignItems: 'center',
            fontFamily: '"Pretendard", -apple-system, BlinkMacSystemFont, system-ui, sans-serif'
          }
        },
          React.createElement('div', {
            style: {
              background: 'white',
              padding: '3rem',
              borderRadius: '16px',
              textAlign: 'center',
              boxShadow: '0 20px 60px rgba(0, 0, 0, 0.3)'
            }
          },
            React.createElement('div', {
              style: {
                fontSize: '3rem',
                marginBottom: '1rem'
              }
            }, 'ğŸ“¦'),
            React.createElement('h2', {
              style: {
                margin: '0 0 0.5rem 0',
                fontSize: '1.5rem',
                color: '#2d3748'
              }
            }, 'ì„¤ì • ë¡œë”© ì¤‘...'),
            React.createElement('p', {
              style: {
                margin: 0,
                color: '#64748b',
                fontSize: '0.95rem'
              }
            }, 'review-setting ì‹œíŠ¸ì—ì„œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ê³  ìˆìŠµë‹ˆë‹¤.')
          )
        );
      }

      return React.createElement('div', {
        style: {
          minHeight: '100vh',
          background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
          padding: '2rem',
          fontFamily: '"Pretendard", -apple-system, BlinkMacSystemFont, system-ui, sans-serif'
        }
      },
        React.createElement('div', {
          style: {
            maxWidth: '1400px',
            margin: '0 auto',
            background: 'rgba(255, 255, 255, 0.95)',
            borderRadius: '24px',
            boxShadow: '0 20px 60px rgba(0, 0, 0, 0.3)',
            overflow: 'hidden'
          }
        },
          // Header
          React.createElement('div', {
            style: {
              background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
              padding: '2rem',
              color: 'white'
            }
          },
            React.createElement('h1', {
              style: {
                margin: 0,
                fontSize: '2rem',
                fontWeight: '700',
                letterSpacing: '-0.5px'
              }
            }, 'ğŸ“¦ ì£¼ë¬¸ ê´€ë¦¬ ì‹œìŠ¤í…œ'),
            React.createElement('p', {
              style: {
                margin: '0.5rem 0 0 0',
                opacity: 0.9,
                fontSize: '0.95rem'
              }
            }, 'ëª¨ë“  ì‡¼í•‘ëª° ì§€ì› | ìë™ íŒŒì‹± + ìˆ˜ë™ ìˆ˜ì •')
          ),

          React.createElement('div', { style: { padding: '2rem' } },
            // ì—ëŸ¬ ë©”ì‹œì§€
            configError && React.createElement('div', {
              style: {
                background: '#fef2f2',
                border: '1px solid #fca5a5',
                borderRadius: '8px',
                padding: '1rem',
                marginBottom: '1.5rem',
                color: '#991b1b',
                fontSize: '0.9rem'
              }
            }, configError),

            // ì£¼ë¬¸ ì…ë ¥ ì˜ì—­
            React.createElement('div', {
              style: {
                display: 'flex',
                justifyContent: 'space-between',
                alignItems: 'center',
                marginBottom: '1.5rem'
              }
            },
              React.createElement('h2', {
                style: {
                  fontSize: '1.3rem',
                  fontWeight: '600',
                  margin: 0,
                  color: '#2d3748'
                }
              }, `ğŸ“‹ ì£¼ë¬¸ ì…ë ¥ (${orders.length}ê°œ)`),
              React.createElement('button', {
                onClick: addOrder,
                style: {
                  background: '#10b981',
                  color: 'white',
                  border: 'none',
                  padding: '0.75rem 1.5rem',
                  borderRadius: '8px',
                  fontSize: '0.95rem',
                  fontWeight: '600',
                  cursor: 'pointer',
                  display: 'flex',
                  alignItems: 'center',
                  gap: '0.5rem'
                }
              }, 'â• ì£¼ë¬¸ ì¶”ê°€')
            ),

            // ì£¼ë¬¸ ëª©ë¡
            orders.map((order, index) => (
              React.createElement('div', {
                key: order.id,
                style: {
                  background: '#f8fafc',
                  border: order.parsed ? '2px solid #10b981' : '2px solid #e2e8f0',
                  borderRadius: '12px',
                  padding: '1.5rem',
                  marginBottom: '1.5rem'
                }
              },
                // í—¤ë”
                React.createElement('div', {
                  style: {
                    display: 'flex',
                    justifyContent: 'space-between',
                    alignItems: 'center',
                    marginBottom: '1rem'
                  }
                },
                  React.createElement('h3', {
                    style: {
                      fontSize: '1.1rem',
                      fontWeight: '600',
                      color: '#1e293b',
                      margin: 0
                    }
                  }, `ì£¼ë¬¸ ${index + 1}`),
                  orders.length > 1 && React.createElement('button', {
                    onClick: () => removeOrder(order.id),
                    style: {
                      background: '#ef4444',
                      color: 'white',
                      border: 'none',
                      padding: '0.5rem 1rem',
                      borderRadius: '6px',
                      fontSize: '0.85rem',
                      cursor: 'pointer'
                    }
                  }, 'âŒ ì‚­ì œ')
                ),

                // í…ìŠ¤íŠ¸ ì…ë ¥
                React.createElement('div', { style: { marginBottom: '1rem' } },
                  React.createElement('label', {
                    style: {
                      display: 'block',
                      fontSize: '0.85rem',
                      fontWeight: '500',
                      color: '#475569',
                      marginBottom: '0.5rem'
                    }
                  }, 'ì£¼ë¬¸ ì •ë³´ ë¶™ì—¬ë„£ê¸°'),
                  React.createElement('textarea', {
                    value: order.rawText,
                    onChange: (e) => handlePaste(index, e.target.value),
                    placeholder: 'ì¿ íŒ¡, ë„¤ì´ë²„, ì˜¥ì…˜ ë“± ì£¼ë¬¸ í˜ì´ì§€ì—ì„œ ë³µì‚¬í•œ ë‚´ìš©ì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”...',
                    style: {
                      width: '100%',
                      minHeight: '100px',
                      padding: '0.75rem',
                      border: '1px solid #cbd5e1',
                      borderRadius: '8px',
                      fontSize: '0.9rem',
                      fontFamily: 'inherit',
                      resize: 'vertical'
                    }
                  })
                ),

                // íŒŒì‹± ê²°ê³¼
                order.parsed && React.createElement('div', {
                  style: {
                    background: '#f0fdf4',
                    border: '1px solid #86efac',
                    borderRadius: '8px',
                    padding: '0.75rem',
                    marginBottom: '1rem',
                    fontSize: '0.85rem',
                    color: '#166534'
                  }
                }, `âœ“ ${order.site || 'ì‚¬ì´íŠ¸'} ê°ì§€ë¨ | ì£¼ë¬¸ë²ˆí˜¸: ${order.orderNumber.slice(0, 10)}... | ê¸ˆì•¡: ${parseInt(order.price || 0).toLocaleString()}ì›`),

                // ìˆ˜ë™ ì…ë ¥/ìˆ˜ì • í¼
                React.createElement('div', {
                  style: {
                    background: 'white',
                    border: '1px solid #e2e8f0',
                    borderRadius: '8px',
                    padding: '1rem',
                    marginBottom: '1rem'
                  }
                },
                  React.createElement('div', {
                    style: {
                      fontSize: '0.9rem',
                      fontWeight: '600',
                      color: '#64748b',
                      marginBottom: '1rem'
                    }
                  }, 'ğŸ“ ì£¼ë¬¸ ì •ë³´ í™•ì¸/ìˆ˜ì •'),

                  React.createElement('div', {
                    style: {
                      display: 'grid',
                      gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',
                      gap: '1rem'
                    }
                  },
                    // ì‚¬ì´íŠ¸
                    React.createElement('div', null,
                      React.createElement('label', {
                        style: {
                          display: 'block',
                          fontSize: '0.8rem',
                          fontWeight: '500',
                          color: '#475569',
                          marginBottom: '0.5rem'
                        }
                      }, 'ì‚¬ì´íŠ¸'),
                      React.createElement('select', {
                        value: order.site,
                        onChange: (e) => updateOrder(index, 'site', e.target.value),
                        style: {
                          width: '100%',
                          padding: '0.5rem',
                          border: '1px solid #cbd5e1',
                          borderRadius: '6px',
                          fontSize: '0.9rem'
                        }
                      }, 
                        React.createElement('option', { value: '' }, 'ì„ íƒ'),
                        SITES.map(site => React.createElement('option', { key: site, value: site }, site))
                      )
                    ),

                    // ì‚¬ì´íŠ¸ ì§ì ‘ì…ë ¥ ì¹¸
                    order.site === 'ì§ì ‘ì…ë ¥' && React.createElement('div', null,
                      React.createElement('label', {
                        style: {
                          display: 'block',
                          fontSize: '0.8rem',
                          fontWeight: '500',
                          color: '#475569',
                          marginBottom: '0.5rem'
                        }
                      }, 'ì‚¬ì´íŠ¸ëª… ì…ë ¥'),
                      React.createElement('input', {
                        type: 'text',
                        value: order.customSite || '',
                        onChange: (e) => updateOrder(index, 'customSite', e.target.value),
                        placeholder: 'ì‚¬ì´íŠ¸ëª…ì„ ì…ë ¥í•˜ì„¸ìš”',
                        style: {
                          width: '100%',
                          padding: '0.5rem',
                          border: '2px solid #3b82f6',
                          borderRadius: '6px',
                          fontSize: '0.9rem'
                        }
                      })
                    ),

                    // ì£¼ë¬¸ë²ˆí˜¸
                    React.createElement('div', null,
                      React.createElement('label', {
                        style: {
                          display: 'block',
                          fontSize: '0.8rem',
                          fontWeight: '500',
                          color: '#475569',
                          marginBottom: '0.5rem'
                        }
                      }, 'ì£¼ë¬¸ë²ˆí˜¸'),
                      React.createElement('input', {
                        type: 'text',
                        value: order.orderNumber,
                        onChange: (e) => updateOrder(index, 'orderNumber', e.target.value),
                        placeholder: 'ì§ì ‘ ì…ë ¥',
                        style: {
                          width: '100%',
                          padding: '0.5rem',
                          border: '1px solid #cbd5e1',
                          borderRadius: '6px',
                          fontSize: '0.9rem',
                          fontFamily: 'monospace'
                        }
                      })
                    ),

                    // ê¸ˆì•¡
                    React.createElement('div', null,
                      React.createElement('label', {
                        style: {
                          display: 'block',
                          fontSize: '0.8rem',
                          fontWeight: '500',
                          color: '#475569',
                          marginBottom: '0.5rem'
                        }
                      }, 'ê¸ˆì•¡'),
                      React.createElement('input', {
                        type: 'text',
                        value: order.price,
                        onChange: (e) => updateOrder(index, 'price', e.target.value.replace(/[^0-9]/g, '')),
                        placeholder: 'ì§ì ‘ ì…ë ¥',
                        style: {
                          width: '100%',
                          padding: '0.5rem',
                          border: '1px solid #cbd5e1',
                          borderRadius: '6px',
                          fontSize: '0.9rem'
                        }
                      })
                    ),

                    // ìƒí’ˆ URL
                    React.createElement('div', null,
                      React.createElement('label', {
                        style: {
                          display: 'block',
                          fontSize: '0.8rem',
                          fontWeight: '500',
                          color: '#475569',
                          marginBottom: '0.5rem'
                        }
                      }, 'ìƒí’ˆ URL (ì„ íƒ)'),
                      React.createElement('input', {
                        type: 'text',
                        value: order.productUrl || '',
                        onChange: (e) => updateOrder(index, 'productUrl', e.target.value),
                        placeholder: 'https://...',
                        style: {
                          width: '100%',
                          padding: '0.5rem',
                          border: '1px solid #cbd5e1',
                          borderRadius: '6px',
                          fontSize: '0.9rem'
                        }
                      })
                    )
                  )
                ),

                // ì£¼ë¬¸ì ì„¤ì •
                React.createElement('div', {
                  style: {
                    display: 'grid',
                    gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))',
                    gap: '1rem'
                  }
                },
                  // ì£¼ë¬¸ì
                  React.createElement('div', null,
                    React.createElement('label', {
                      style: {
                        display: 'block',
                        fontSize: '0.8rem',
                        fontWeight: '500',
                        color: '#475569',
                        marginBottom: '0.5rem'
                      }
                    }, 'ì£¼ë¬¸ì'),
                    React.createElement('select', {
                      value: order.person,
                      onChange: (e) => updateOrder(index, 'person', e.target.value),
                      style: {
                        width: '100%',
                        padding: '0.5rem',
                        border: '1px solid #cbd5e1',
                        borderRadius: '6px',
                        fontSize: '0.9rem'
                      }
                    }, Object.keys(PRESETS).map(name =>
                      React.createElement('option', { key: name, value: name }, name)
                    ))
                  ),

                  // ID
                  React.createElement('div', null,
                    React.createElement('label', {
                      style: {
                        display: 'block',
                        fontSize: '0.8rem',
                        fontWeight: '500',
                        color: '#475569',
                        marginBottom: '0.5rem'
                      }
                    }, 'ID'),
                    React.createElement('select', {
                      value: order.personId,
                      onChange: (e) => updateOrder(index, 'personId', e.target.value),
                      style: {
                        width: '100%',
                        padding: '0.5rem',
                        border: '1px solid #cbd5e1',
                        borderRadius: '6px',
                        fontSize: '0.9rem'
                      }
                    }, 
                      // ë°ì´í„° í…Œì´ë¸”ì˜ ì‚¬ì´íŠ¸ ì •ë³´ë¡œ ì•„ì´ë”” ëª©ë¡ ê²°ì •
                      (() => {
                        const selectedSite = selectedOrders.length > 0 ? editableData[selectedOrders[0]]?.site : '';
                        const currentSiteIds = SITE_IDS[selectedSite] || IDS || ['ì§ì ‘ì…ë ¥'];
                        console.log('ì„ íƒëœ ì‚¬ì´íŠ¸:', selectedSite, 'ì•„ì´ë”” ëª©ë¡:', currentSiteIds);
                        return currentSiteIds.map(id => 
                          React.createElement('option', { key: id, value: id }, id)
                        );
                      })()
                    )
                  ),

                  // ID ì§ì ‘ì…ë ¥ ì¹¸
                  order.personId === 'ì§ì ‘ì…ë ¥' && React.createElement('div', null,
                    React.createElement('label', {
                      style: {
                        display: 'block',
                        fontSize: '0.8rem',
                        fontWeight: '500',
                        color: '#475569',
                        marginBottom: '0.5rem'
                      }
                    }, 'ID ì…ë ¥'),
                    React.createElement('input', {
                      type: 'text',
                      value: order.customId || '',
                      onChange: (e) => updateOrder(index, 'customId', e.target.value),
                      placeholder: 'IDë¥¼ ì…ë ¥í•˜ì„¸ìš”',
                      style: {
                        width: '100%',
                        padding: '0.5rem',
                        border: '2px solid #3b82f6',
                        borderRadius: '6px',
                        fontSize: '0.9rem'
                      }
                    })
                  ),

                  // ì¹´ë“œ
                  React.createElement('div', null,
                    React.createElement('label', {
                      style: {
                        display: 'block',
                        fontSize: '0.8rem',
                        fontWeight: '500',
                        color: '#475569',
                        marginBottom: '0.5rem'
                      }
                    }, 'ì¹´ë“œ'),
                    React.createElement('select', {
                      value: order.card,
                      onChange: (e) => updateOrder(index, 'card', e.target.value),
                      style: {
                        width: '100%',
                        padding: '0.5rem',
                        border: '1px solid #cbd5e1',
                        borderRadius: '6px',
                        fontSize: '0.9rem'
                      }
                    }, CARDS.map(card =>
                      React.createElement('option', { key: card, value: card }, card)
                    ))
                  ),

                  // ë°°ì†¡
                  React.createElement('div', null,
                    React.createElement('label', {
                      style: {
                        display: 'block',
                        fontSize: '0.8rem',
                        fontWeight: '500',
                        color: '#475569',
                        marginBottom: '0.5rem'
                      }
                    }, 'ë°°ì†¡'),
                    React.createElement('select', {
                      value: order.deliveryType,
                      onChange: (e) => updateOrder(index, 'deliveryType', e.target.value),
                      style: {
                        width: '100%',
                        padding: '0.5rem',
                        border: '1px solid #cbd5e1',
                        borderRadius: '6px',
                        fontSize: '0.9rem'
                      }
                    }, DELIVERY_TYPES.map(type =>
                      React.createElement('option', { key: type, value: type }, type)
                    ))
                  ),

                  // ë¦¬ë·°
                  React.createElement('div', null,
                    React.createElement('label', {
                      style: {
                        display: 'block',
                        fontSize: '0.8rem',
                        fontWeight: '500',
                        color: '#475569',
                        marginBottom: '0.5rem'
                      }
                    }, 'ë¦¬ë·°'),
                    React.createElement('select', {
                      value: order.reviewMethod,
                      onChange: (e) => updateOrder(index, 'reviewMethod', e.target.value),
                      style: {
                        width: '100%',
                        padding: '0.5rem',
                        border: '1px solid #cbd5e1',
                        borderRadius: '6px',
                        fontSize: '0.9rem'
                      }
                    }, REVIEW_METHODS.map(method =>
                      React.createElement('option', { key: method, value: method }, method)
                    ))
                  ),

                  // ë¦½ë¹„
                  React.createElement('div', null,
                    React.createElement('label', {
                      style: {
                        display: 'block',
                        fontSize: '0.8rem',
                        fontWeight: '500',
                        color: '#475569',
                        marginBottom: '0.5rem'
                      }
                    }, 'ë¦½ë¹„'),
                    React.createElement('select', {
                      value: order.reviewFee,
                      onChange: (e) => updateOrder(index, 'reviewFee', e.target.value),
                      style: {
                        width: '100%',
                        padding: '0.5rem',
                        border: '1px solid #cbd5e1',
                        borderRadius: '6px',
                        fontSize: '0.9rem'
                      }
                    }, REVIEW_FEES.map(fee =>
                      React.createElement('option', { key: fee, value: fee }, fee)
                    ))
                  ),

                  // ë¦½ë¹„ ì§ì ‘ì…ë ¥
                  order.reviewFee === 'ì§ì ‘ì…ë ¥' && React.createElement('div', null,
                    React.createElement('input', {
                      type: 'text',
                      value: order.customFee || '',
                      onChange: (e) => updateOrder(index, 'customFee', e.target.value.replace(/[^0-9]/g, '')),
                      placeholder: 'ê¸ˆì•¡ ì…ë ¥ (ìˆ«ìë§Œ)',
                      style: {
                        width: '100%',
                        padding: '0.5rem',
                        border: '2px solid #3b82f6',
                        borderRadius: '6px',
                        fontSize: '0.9rem',
                        marginTop: '0.5rem'
                      }
                    })
                  )
                ),

                // ê°€ì´ë“œë¼ì¸
                React.createElement('div', { style: { marginTop: '1rem' } },
                  React.createElement('label', {
                    style: {
                      display: 'block',
                      fontSize: '0.8rem',
                      fontWeight: '500',
                      color: '#475569',
                      marginBottom: '0.5rem'
                    }
                  }, 'ê°€ì´ë“œë¼ì¸'),
                  React.createElement('textarea', {
                    value: order.guideline,
                    onChange: (e) => updateOrder(index, 'guideline', e.target.value),
                    placeholder: 'íŒë§¤ì ê°€ì´ë“œë¼ì¸ì„ ì…ë ¥í•˜ì„¸ìš”...',
                    style: {
                      width: '100%',
                      minHeight: '60px',
                      padding: '0.5rem',
                      border: '1px solid #cbd5e1',
                      borderRadius: '6px',
                      fontSize: '0.9rem',
                      fontFamily: 'inherit',
                      resize: 'vertical'
                    }
                  })
                )
              )
            )),

            // ê³µí†µ ì„¤ì •
            React.createElement('div', {
              style: {
                background: '#f8fafc',
                border: '2px solid #e2e8f0',
                borderRadius: '12px',
                padding: '1.5rem',
                marginBottom: '1.5rem'
              }
            },
              React.createElement('h2', {
                style: {
                  fontSize: '1.3rem',
                  fontWeight: '600',
                  marginBottom: '1rem',
                  color: '#2d3748'
                }
              }, 'ğŸ’³ ê³µí†µ ì„¤ì •'),

              React.createElement('div', {
                style: {
                  display: 'grid',
                  gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',
                  gap: '1rem',
                  marginBottom: '1rem'
                }
              },
                // ì£¼ë¬¸ì
                React.createElement('div', null,
                  React.createElement('label', {
                    style: {
                      display: 'block',
                      fontSize: '0.85rem',
                      fontWeight: '500',
                      color: '#475569',
                      marginBottom: '0.5rem'
                    }
                  }, 'ì£¼ë¬¸ì (ì¼ê´„ ì ìš©)'),
                  React.createElement('select', {
                    value: commonSettings.person || '',
                    onChange: (e) => setCommonSettings({...commonSettings, person: e.target.value}),
                    style: {
                      width: '100%',
                      padding: '0.5rem',
                      border: '1px solid #cbd5e1',
                      borderRadius: '6px',
                      fontSize: '0.9rem'
                    }
                  }, 
                    React.createElement('option', { value: '' }, 'ì„ íƒ ì•ˆí•¨ (ìë™)'),
                    Object.keys(PRESETS).map(name =>
                      React.createElement('option', { key: name, value: name }, name)
                    )
                  )
                ),

                // ê±°ë˜ì¼ì
                React.createElement('div', null,
                  React.createElement('label', {
                    style: {
                      display: 'block',
                      fontSize: '0.85rem',
                      fontWeight: '500',
                      color: '#475569',
                      marginBottom: '0.5rem'
                    }
                  }, 'ê±°ë˜ì¼ì'),
                  React.createElement('input', {
                    type: 'date',
                    value: commonSettings.transactionDate,
                    onChange: (e) => setCommonSettings({...commonSettings, transactionDate: e.target.value}),
                    style: {
                      width: '100%',
                      padding: '0.5rem',
                      border: '1px solid #cbd5e1',
                      borderRadius: '6px',
                      fontSize: '0.9rem'
                    }
                  })
                ),

                // í†¡ë°©ì´ë¦„
                React.createElement('div', null,
                  React.createElement('label', {
                    style: {
                      display: 'block',
                      fontSize: '0.85rem',
                      fontWeight: '500',
                      color: '#475569',
                      marginBottom: '0.5rem'
                    }
                  }, 'í†¡ë°©ì´ë¦„'),
                  React.createElement('input', {
                    type: 'text',
                    value: commonSettings.talkRoomName,
                    onChange: (e) => setCommonSettings({...commonSettings, talkRoomName: e.target.value}),
                    placeholder: 'ì˜ˆ: AD ë°©ëª…',
                    style: {
                      width: '100%',
                      padding: '0.5rem',
                      border: '1px solid #cbd5e1',
                      borderRadius: '6px',
                      fontSize: '0.9rem'
                    }
                  })
                ),

                // ë°°ì†¡í˜•íƒœ
                React.createElement('div', null,
                  React.createElement('label', {
                    style: {
                      display: 'block',
                      fontSize: '0.85rem',
                      fontWeight: '500',
                      color: '#475569',
                      marginBottom: '0.5rem'
                    }
                  }, 'ë°°ì†¡í˜•íƒœ'),
                  React.createElement('select', {
                    value: commonSettings.deliveryType,
                    onChange: (e) => setCommonSettings({...commonSettings, deliveryType: e.target.value}),
                    style: {
                      width: '100%',
                      padding: '0.5rem',
                      border: '1px solid #cbd5e1',
                      borderRadius: '6px',
                      fontSize: '0.9rem'
                    }
                  }, DELIVERY_TYPES.map(type =>
                    React.createElement('option', { key: type, value: type }, type)
                  ))
                ),

                // ë¦¬ë·°ë°©ë²•
                React.createElement('div', null,
                  React.createElement('label', {
                    style: {
                      display: 'block',
                      fontSize: '0.85rem',
                      fontWeight: '500',
                      color: '#475569',
                      marginBottom: '0.5rem'
                    }
                  }, 'ë¦¬ë·°ë°©ë²•'),
                  React.createElement('select', {
                    value: commonSettings.reviewMethod,
                    onChange: (e) => setCommonSettings({...commonSettings, reviewMethod: e.target.value}),
                    style: {
                      width: '100%',
                      padding: '0.5rem',
                      border: '1px solid #cbd5e1',
                      borderRadius: '6px',
                      fontSize: '0.9rem'
                    }
                  }, REVIEW_METHODS.map(method =>
                    React.createElement('option', { key: method, value: method }, method)
                  ))
                ),

                // ë¦½ë¹„
                React.createElement('div', null,
                  React.createElement('label', {
                    style: {
                      display: 'block',
                      fontSize: '0.85rem',
                      fontWeight: '500',
                      color: '#475569',
                      marginBottom: '0.5rem'
                    }
                  }, 'ë¦½ë¹„'),
                  React.createElement('select', {
                    value: commonSettings.reviewFee,
                    onChange: (e) => setCommonSettings({...commonSettings, reviewFee: e.target.value}),
                    style: {
                      width: '100%',
                      padding: '0.5rem',
                      border: '1px solid #cbd5e1',
                      borderRadius: '6px',
                      fontSize: '0.9rem'
                    }
                  }, REVIEW_FEES.map(fee =>
                    React.createElement('option', { key: fee, value: fee }, fee)
                  ))
                ),

                // ë¦½ë¹„ ì§ì ‘ì…ë ¥
                commonSettings.reviewFee === 'ì§ì ‘ì…ë ¥' && React.createElement('div', null,
                  React.createElement('label', {
                    style: {
                      display: 'block',
                      fontSize: '0.85rem',
                      fontWeight: '500',
                      color: '#475569',
                      marginBottom: '0.5rem'
                    }
                  }, 'ë¦½ë¹„ ê¸ˆì•¡'),
                  React.createElement('input', {
                    type: 'text',
                    value: commonSettings.customReviewFee || '',
                    onChange: (e) => setCommonSettings({...commonSettings, customReviewFee: e.target.value.replace(/[^0-9]/g, '')}),
                    placeholder: 'ê¸ˆì•¡ ì…ë ¥',
                    style: {
                      width: '100%',
                      padding: '0.5rem',
                      border: '2px solid #3b82f6',
                      borderRadius: '6px',
                      fontSize: '0.9rem'
                    }
                  })
                )
              ),

              // ê°€ì´ë“œë¼ì¸ ì¼ê´„ì…ë ¥
              React.createElement('div', { style: { marginBottom: '1rem' } },
                React.createElement('label', {
                  style: {
                    display: 'block',
                    fontSize: '0.85rem',
                    fontWeight: '500',
                    color: '#475569',
                    marginBottom: '0.5rem'
                  }
                }, 'ê°€ì´ë“œë¼ì¸ ì¼ê´„ì…ë ¥'),
                React.createElement('textarea', {
                  value: commonSettings.guideline,
                  onChange: (e) => setCommonSettings({...commonSettings, guideline: e.target.value}),
                  placeholder: 'ëª¨ë“  ì£¼ë¬¸ì— ì ìš©í•  ê°€ì´ë“œë¼ì¸...',
                  style: {
                    width: '100%',
                    minHeight: '60px',
                    padding: '0.5rem',
                    border: '1px solid #cbd5e1',
                    borderRadius: '6px',
                    fontSize: '0.9rem',
                    fontFamily: 'inherit',
                    resize: 'vertical'
                  }
                })
              ),

              React.createElement('button', {
                onClick: applyCommonSettings,
                style: {
                  background: '#10b981',
                  color: 'white',
                  border: 'none',
                  padding: '0.75rem 1.5rem',
                  borderRadius: '8px',
                  fontSize: '0.95rem',
                  fontWeight: '600',
                  cursor: 'pointer'
                }
              }, 'âš¡ ê³µí†µì„¤ì • ëª¨ë“  ì£¼ë¬¸ì— ì ìš©')
            ),

            // ì¶œë ¥ ì„¤ì • (ìƒˆ ë²„ì „)
            React.createElement('div', {
              style: {
                background: '#f8fafc',
                border: '2px solid #e2e8f0',
                borderRadius: '12px',
                padding: '1.5rem',
                marginBottom: '1.5rem'
              }
            },
              React.createElement('h2', {
                style: {
                  fontSize: '1.3rem',
                  fontWeight: '600',
                  marginBottom: '1rem',
                  color: '#2d3748'
                }
              }, 'ğŸ“‹ ì¶œë ¥ ì„¤ì •'),

              // 1. í¼ ì–‘ì‹ ì…ë ¥
              React.createElement('div', { style: { marginBottom: '1.5rem' } },
                React.createElement('label', {
                  style: {
                    display: 'block',
                    fontSize: '0.95rem',
                    fontWeight: '600',
                    color: '#475569',
                    marginBottom: '0.5rem'
                  }
                }, '1. í¼ ì–‘ì‹ ì…ë ¥'),
                React.createElement('div', {
                  style: {
                    display: 'flex',
                    justifyContent: 'space-between',
                    alignItems: 'center',
                    marginBottom: '0.5rem'
                  }
                },
                  React.createElement('div'),
                  Object.keys(learnedMappings).length > 0 && React.createElement('button', {
                    onClick: () => {
                      if (confirm(`í•™ìŠµëœ ${Object.keys(learnedMappings).length}ê°œ ë§¤í•‘ì„ ëª¨ë‘ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                        setLearnedMappings({});
                        localStorage.removeItem('learnedMappings');
                        alert('âœ… í•™ìŠµ ë°ì´í„°ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤');
                      }
                    },
                    style: {
                      fontSize: '0.75rem',
                      padding: '0.25rem 0.5rem',
                      background: '#fef2f2',
                      border: '1px solid #fca5a5',
                      borderRadius: '4px',
                      color: '#991b1b',
                      cursor: 'pointer'
                    }
                  }, `ğŸ“š í•™ìŠµëœ ë§¤í•‘ ${Object.keys(learnedMappings).length}ê°œ`)
                ),
                React.createElement('textarea', {
                  value: formTemplate,
                  onChange: (e) => setFormTemplate(e.target.value),
                  placeholder: `í¼ ì–‘ì‹ì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”:

ì˜ˆì‹œ 1 (ë¼ë²¨):
ì´ë¦„:
ì£¼ë¬¸ë²ˆí˜¸:
ì•„ì´ë””:

ì˜ˆì‹œ 2 (ìŠ¬ë˜ì‹œ):
ì´ë¦„ / ì „í™”ë²ˆí˜¸ / ì£¼ì†Œ`,
                  style: {
                    width: '100%',
                    minHeight: '120px',
                    padding: '0.75rem',
                    border: '1px solid #cbd5e1',
                    borderRadius: '8px',
                    fontSize: '0.9rem',
                    fontFamily: 'monospace',
                    resize: 'vertical'
                  }
                }),
                React.createElement('div', {
                  style: {
                    marginTop: '0.5rem',
                    display: 'flex',
                    alignItems: 'center',
                    gap: '0.5rem'
                  }
                },
                  React.createElement('input', {
                    type: 'checkbox',
                    checked: removeLabels,
                    onChange: (e) => setRemoveLabels(e.target.checked),
                    style: { cursor: 'pointer' }
                  }),
                  React.createElement('label', {
                    style: {
                      fontSize: '0.9rem',
                      color: '#475569',
                      cursor: 'pointer'
                    },
                    onClick: () => setRemoveLabels(!removeLabels)
                  }, 'ë¼ë²¨ ì œê±° (ê°’ë§Œ ì¶œë ¥)')
                )
              ),

              // 2. ì£¼ë¬¸ ì„ íƒ
              React.createElement('div', { style: { marginBottom: '1.5rem' } },
                React.createElement('label', {
                  style: {
                    display: 'block',
                    fontSize: '0.95rem',
                    fontWeight: '600',
                    color: '#475569',
                    marginBottom: '0.75rem'
                  }
                }, `2. ì¶œë ¥í•  ì£¼ë¬¸ ì„ íƒ (${selectedOrders.length}/${orders.length})`),
                React.createElement('div', {
                  style: {
                    display: 'flex',
                    gap: '1rem',
                    flexWrap: 'wrap'
                  }
                }, orders.map((order, index) =>
                  React.createElement('div', {
                    key: order.id,
                    style: {
                      display: 'flex',
                      alignItems: 'center',
                      gap: '0.5rem',
                      padding: '0.75rem',
                      background: selectedOrders.includes(index) ? '#dbeafe' : 'white',
                      border: `2px solid ${selectedOrders.includes(index) ? '#3b82f6' : '#e2e8f0'}`,
                      borderRadius: '8px',
                      cursor: 'pointer',
                      transition: 'all 0.2s'
                    },
                    onClick: () => toggleOrderSelection(index)
                  },
                    React.createElement('input', {
                      type: 'checkbox',
                      checked: selectedOrders.includes(index),
                      onChange: () => {},
                      style: { cursor: 'pointer' }
                    }),
                    React.createElement('div', {
                      style: {
                        fontSize: '0.9rem',
                        fontWeight: '500',
                        color: '#1e293b'
                      }
                    }, `ì£¼ë¬¸ ${index + 1}`),
                    React.createElement('div', {
                      style: {
                        fontSize: '0.8rem',
                        color: '#64748b'
                      }
                    }, `(${PRESETS[order.person]?.name || 'ë¯¸ì„¤ì •'})`)
                  )
                )),
                React.createElement('button', {
                  onClick: () => setSelectedOrders(orders.map((_, i) => i)),
                  style: {
                    marginTop: '0.5rem',
                    padding: '0.5rem 1rem',
                    background: '#f1f5f9',
                    border: '1px solid #cbd5e1',
                    borderRadius: '6px',
                    fontSize: '0.85rem',
                    cursor: 'pointer'
                  }
                }, 'ì „ì²´ ì„ íƒ')
              ),

              // 3. ë°ì´í„° í¸ì§‘ í…Œì´ë¸”
              selectedOrders.length > 0 && formTemplate && React.createElement('div', { 
                style: { 
                  marginBottom: '1.5rem',
                  marginTop: '1.5rem'
                } 
              },
                React.createElement('label', {
                  style: {
                    display: 'block',
                    fontSize: '0.95rem',
                    fontWeight: '600',
                    color: '#475569',
                    marginBottom: '0.75rem'
                  }
                }, '3. ë°ì´í„° í¸ì§‘'),
                React.createElement('div', {
                  style: {
                    overflowX: 'auto',
                    background: 'white',
                    border: '1px solid #e2e8f0',
                    borderRadius: '8px',
                    padding: '1rem'
                  }
                },
                  parseFormTemplate(formTemplate).map(field => {
                    const key = mapFieldToKey(field);
                    const isUnknown = key === field; // ë§¤í•‘ì„ ëª¨ë¥´ëŠ” ê²½ìš°
                    
                    return React.createElement('div', {
                      key: field,
                      style: {
                        display: 'flex',
                        alignItems: 'center',
                        gap: '1rem',
                        marginBottom: '0.75rem',
                        paddingBottom: '0.75rem',
                        borderBottom: '1px solid #f1f5f9'
                      }
                    },
                      // ë¼ë²¨ëª…
                      React.createElement('div', {
                        style: {
                          minWidth: '120px',
                          display: 'flex',
                          flexDirection: 'column',
                          gap: '0.25rem'
                        }
                      },
                        React.createElement('div', {
                          style: {
                            fontWeight: '500',
                            fontSize: '0.9rem',
                            color: isUnknown ? '#ef4444' : '#475569'
                          }
                        }, field),
                        
                        // ì•Œ ìˆ˜ ì—†ëŠ” ë¼ë²¨ì¼ ê²½ìš° í•™ìŠµ ì˜µì…˜ í‘œì‹œ
                        isUnknown && React.createElement('select', {
                          onChange: (e) => {
                            if (e.target.value) {
                              saveLearnedMapping(field, e.target.value);
                            }
                          },
                          style: {
                            fontSize: '0.75rem',
                            padding: '0.25rem',
                            border: '1px solid #fca5a5',
                            borderRadius: '4px',
                            background: '#fef2f2',
                            color: '#991b1b',
                            cursor: 'pointer'
                          }
                        },
                          React.createElement('option', { value: '' }, 'í•­ëª© ì„ íƒ'),
                          React.createElement('option', { value: 'name' }, 'ì´ë¦„'),
                          React.createElement('option', { value: 'receiver' }, 'ìˆ˜ì·¨ì¸'),
                          React.createElement('option', { value: 'orderNumber' }, 'ì£¼ë¬¸ë²ˆí˜¸'),
                          React.createElement('option', { value: 'personId' }, 'ì•„ì´ë””'),
                          React.createElement('option', { value: 'phone' }, 'ì „í™”ë²ˆí˜¸'),
                          React.createElement('option', { value: 'phoneNoHyphen' }, 'ì „í™”ë²ˆí˜¸(í•˜ì´í”ˆì—†ìŒ)'),
                          React.createElement('option', { value: 'address' }, 'ì£¼ì†Œ'),
                          React.createElement('option', { value: 'price' }, 'ê¸ˆì•¡'),
                          React.createElement('option', { value: 'site' }, 'ì‚¬ì´íŠ¸'),
                          React.createElement('option', { value: 'card' }, 'ì¹´ë“œ'),
                          React.createElement('option', { value: 'bank' }, 'ì€í–‰'),
                          React.createElement('option', { value: 'accountWithHyphen' }, 'ê³„ì¢Œë²ˆí˜¸'),
                          React.createElement('option', { value: 'account' }, 'ê³„ì¢Œë²ˆí˜¸(í•˜ì´í”ˆì—†ìŒ)'),
                          React.createElement('option', { value: 'deliveryType' }, 'ë°°ì†¡'),
                          React.createElement('option', { value: 'reviewMethod' }, 'ë¦¬ë·°'),
                          React.createElement('option', { value: 'reviewFee' }, 'ë¦½ë¹„')
                        )
                      ),
                      
                      // ì…ë ¥ ì¹¸ë“¤
                      React.createElement('div', {
                        style: {
                          display: 'flex',
                          gap: '0.5rem',
                          flex: 1,
                          flexWrap: 'wrap'
                        }
                      }, selectedOrders.map(orderIndex => {
                        // ì•„ì´ë”” í•„ë“œëŠ” ë“œë¡­ë‹¤ìš´ìœ¼ë¡œ
                        if (key === 'personId') {
                          const selectedSite = editableData[orderIndex]?.site || '';
                          const currentSiteIds = SITE_IDS[selectedSite] || IDS || ['ì§ì ‘ì…ë ¥'];
                          
                          return React.createElement('select', {
                            key: orderIndex,
                            value: editableData[orderIndex]?.[key] || '',
                            onChange: (e) => updateEditableData(orderIndex, key, e.target.value),
                            style: {
                              flex: '1 1 200px',
                              padding: '0.5rem',
                              border: '1px solid #cbd5e1',
                              borderRadius: '6px',
                              fontSize: '0.85rem',
                              cursor: 'pointer'
                            }
                          },
                            currentSiteIds.map(id => 
                              React.createElement('option', { key: id, value: id }, id)
                            )
                          );
                        }
                        
                        // ë‚˜ë¨¸ì§€ í•„ë“œëŠ” í…ìŠ¤íŠ¸ ì…ë ¥
                        return React.createElement('input', {
                          key: orderIndex,
                          type: 'text',
                          value: editableData[orderIndex]?.[key] || '',
                          onChange: (e) => updateEditableData(orderIndex, key, e.target.value),
                          placeholder: `ì£¼ë¬¸${orderIndex + 1}`,
                          style: {
                            flex: '1 1 200px',
                            padding: '0.5rem',
                            border: '1px solid #cbd5e1',
                            borderRadius: '6px',
                            fontSize: '0.85rem'
                          }
                        });
                      }))
                    );
                  })
                )
              ),

              // 4. ë³µì‚¬ ë²„íŠ¼
              React.createElement('div', {
                style: {
                  display: 'flex',
                  justifyContent: 'center'
                }
              },
                React.createElement('button', {
                  onClick: copyOutputToClipboard,
                  style: {
                    background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                    color: 'white',
                    border: 'none',
                    padding: '1rem 2rem',
                    borderRadius: '8px',
                    fontSize: '1rem',
                    fontWeight: '600',
                    cursor: 'pointer',
                    boxShadow: '0 4px 12px rgba(102, 126, 234, 0.4)'
                  }
                }, 'ğŸ“‹ ë³µì‚¬í•˜ê¸°')
              )
            ),

            // ì €ì¥ / ì´ˆê¸°í™” ë²„íŠ¼
            React.createElement('div', {
              style: {
                marginBottom: '1.5rem'
              }
            },
              React.createElement('h2', {
                style: {
                  fontSize: '1.3rem',
                  fontWeight: '600',
                  marginBottom: '1rem',
                  color: '#2d3748'
                }
              }, 'ğŸ’¾ ë°ì´í„° ê´€ë¦¬'),
              
              React.createElement('div', {
                style: {
                  display: 'flex',
                  gap: '1rem',
                  justifyContent: 'center'
                }
              },
                React.createElement('button', {
                  onClick: saveToGoogleSheets,
                  style: {
                    background: '#10b981',
                    color: 'white',
                    border: 'none',
                    padding: '1rem 2rem',
                    borderRadius: '8px',
                    fontSize: '1rem',
                    fontWeight: '600',
                    cursor: 'pointer',
                    boxShadow: '0 4px 12px rgba(16, 185, 129, 0.4)'
                  }
                }, 'ğŸ’¾ êµ¬ê¸€ì‹œíŠ¸ ì €ì¥'),

                React.createElement('button', {
                  onClick: resetAllOrders,
                  style: {
                    background: '#ef4444',
                    color: 'white',
                    border: 'none',
                    padding: '1rem 2rem',
                    borderRadius: '8px',
                    fontSize: '1rem',
                    fontWeight: '600',
                    cursor: 'pointer',
                    boxShadow: '0 4px 12px rgba(239, 68, 68, 0.4)'
                  }
                }, 'ğŸ—‘ï¸ ì „ì²´ ì´ˆê¸°í™”')
              )
            )
          )
        )
      );
    };

    ReactDOM.render(
      React.createElement(OrderManager),
      document.getElementById('root')
    );
  </script>
</body>
</html>
