<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ï£ºÎ¨∏ Í¥ÄÎ¶¨ ÏãúÏä§ÌÖú</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
        'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
        sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    // Í∏∞Î≥∏Í∞í (admin ÏãúÌä∏ Î°úÎî© Ïã§Ìå® Ïãú ÏÇ¨Ïö©)
    const DEFAULT_PRESETS = {
      "Ïù¥Ìï¥Ïö¥": {
        name: "Ïù¥Ìï¥Ïö¥",
        reviewName: "Ïù¥*Ïö¥",
        phone: "010-7169-7838",
        address: "ÏÑúÏö∏ÌäπÎ≥ÑÏãú Ïö©ÏÇ∞Íµ¨ Ìö®Ï∞ΩÏõêÎ°ú104Îã§Í∏∏ 6",
        coupangId: "iamandy",
        naverId: "iamandy@naver.com",
        bank: "Ïã†ÌïúÏùÄÌñâ",
        account: "110254150254",
        accountWithHyphen: "110254-150254"
      },
      "ÏßÄÏòÅÏã†": {
        name: "ÏßÄÏòÅÏã†",
        reviewName: "ÏßÄ*Ïã†",
        phone: "010-2771-9985",
        address: "Ï∂©Ï≤≠ÎÇ®ÎèÑ ÏÑúÏ≤úÍµ∞ ÏÑúÎ©¥ Î∂ÄÏõêÍ∏∏284Î≤àÍ∏∏ 12",
        coupangId: "dudtls0114",
        naverId: "dudtls00114@gmail.com",
        bank: "Ïã†ÌïúÏùÄÌñâ",
        account: "110254150254",
        accountWithHyphen: "110254-150254"
      },
      "Ï†ïÎèôÏã†": {
        name: "Ï†ïÎèôÏã†",
        reviewName: "Ï†ï*Ïã†",
        phone: "010-9083-9985",
        address: "Í≤ΩÍ∏∞ÎèÑ Í≥†ÏñëÏãú ÏùºÏÇ∞ÏÑúÍµ¨ ÌÉÑÌòÑÎ°ú 136 116Îèô 703Ìò∏",
        coupangId: "wjdehdtls",
        naverId: "wjdehdtls@naver.com",
        bank: "Ïã†ÌïúÏùÄÌñâ",
        account: "110254150254",
        accountWithHyphen: "110254-150254"
      },
      "Ï†ÑÎèôÏó¥": {
        name: "Ï†ÑÎèôÏó¥",
        reviewName: "Ï†Ñ*Ïó¥",
        phone: "010-8019-4657",
        address: "ÏÑúÏö∏ÌäπÎ≥ÑÏãú ÎßàÌè¨Íµ¨ ÌÜ†Ï†ïÎ°ú 223-1",
        coupangId: "dmi2286",
        naverId: "iamandy11@gmail.com",
        bank: "Ïã†ÌïúÏùÄÌñâ",
        account: "110254150254",
        accountWithHyphen: "110254-150254"
      },
      "Ïû•ÏÉõÎ≥Ñ": {
        name: "Ïû•ÏÉõÎ≥Ñ",
        reviewName: "Ïû•*Î≥Ñ",
        phone: "010-2124-7160",
        address: "ÏÑúÏö∏ÌäπÎ≥ÑÏãú ÎßàÌè¨Íµ¨ ÌÜ†Ï†ïÎ°ú 223-1",
        coupangId: "zzang9227",
        naverId: "zzang9227@naver.com",
        bank: "Ïã†ÌïúÏùÄÌñâ",
        account: "110254150254",
        accountWithHyphen: "110254-150254"
      },
      "Ïù¥Ìï¥Î¶º": {
        name: "Ïù¥Ìï¥Î¶º",
        reviewName: "Ïù¥*Î¶º",
        phone: "010-2017-9985",
        address: "Í≤ΩÍ∏∞ÎèÑ Í≥†ÏñëÏãú ÏùºÏÇ∞ÏÑúÍµ¨ ÌÉÑÌòÑÎ°ú 136 116Îèô 703Ìò∏",
        coupangId: "pitosungy",
        naverId: "pitosungy@naver.com",
        bank: "Ïã†ÌïúÏùÄÌñâ",
        account: "110254150254",
        accountWithHyphen: "110254-150254"
      }
    };

    const DEFAULT_SITES = [
      "Ïø†Ìå°", "ÎÑ§Ïù¥Î≤Ñ", "Ïπ¥Ïπ¥Ïò§ÌÜ°ÏáºÌïë", "Ïö∏Î¶ºÎã¨ÏòÅ", "Ïò§ÎäòÏùòÏßë", "Ïò•ÏÖò",
      "GSSHOP", "SSG", "Î¨¥Ïã†ÏÇ¨", "ÌÅ¨Î™Ω", "11Î≤àÍ∞Ä", "Î°ØÎç∞Ïò®", "ÏßÄÎßàÏºì", "ÏßÅÏ†ëÏûÖÎ†•"
    ];

    const DEFAULT_IDS = [
      "iamandy", "dudtls", "wjdehdtls", "iamandy11", 
      "Î≥ÑÏù¥", "haewoon1", "dmi2286", "pitosung"
    ];

    const DEFAULT_CARDS = [
      "ÏôÄÏö∞", "ÎÑ§ÌòÑ", "Ìä∏Î†àÎ∏î",
      "Ïã†-Ïø†", "Í∏à-Ïø†", "Ïã†-ÎÑ§", "Í∏à-ÎÑ§",
      "Ïã†-Ïï±", "Í∏à-Ïï±", "Ïã†-Ïä§", "Í∏à-Ïä§", "Ïã†-ÌÜ†", "Í∏à-ÌÜ†",
      "Ïπ¥Ïã†-Ïø†", "Ïπ¥Ïã†-ÎÑ§", "Ïπ¥Ïã†-Ïï±", "Ïπ¥Ïã†-Ïπ¥", "Ïπ¥Ïã†-ÌÜ†", "Ïπ¥Ïã†-Ïä§"
    ];

    const DEFAULT_DELIVERY_TYPES = ["Ïã§Î∞∞", "Îπà", "ÌöåÏàò"];
    const DEFAULT_REVIEW_METHODS = ["Ìè¨ÌÜ†", "ÌÖçÏä§Ìä∏", "Î≥Ñ", "Íµ¨Ìôï"];
    const DEFAULT_REVIEW_FEES = ["0", "500", "1000", "1500", "ÏßÅÏ†ëÏûÖÎ†•"];

    const OrderManager = () => {
      // ÎèôÏ†Å ÏÑ§Ï†ï (review-setting ÏãúÌä∏ÏóêÏÑú Î°úÎìú)
      const [PRESETS, setPRESETS] = useState(DEFAULT_PRESETS);
      const [SITES, setSITES] = useState(DEFAULT_SITES);
      const [IDS, setIDS] = useState(DEFAULT_IDS);
      const [SITE_IDS, setSITE_IDS] = useState({}); // ÏÇ¨Ïù¥Ìä∏Î≥Ñ ÏïÑÏù¥Îîî
      const [CARDS, setCARDS] = useState(DEFAULT_CARDS);
      const [DELIVERY_TYPES, setDELIVERY_TYPES] = useState(DEFAULT_DELIVERY_TYPES);
      const [REVIEW_METHODS, setREVIEW_METHODS] = useState(DEFAULT_REVIEW_METHODS);
      const [REVIEW_FEES, setREVIEW_FEES] = useState(DEFAULT_REVIEW_FEES);

      // Î°úÎî© ÏÉÅÌÉú
      const [loading, setLoading] = useState(true);
      const [configError, setConfigError] = useState('');

      // review-setting ÏãúÌä∏ÏóêÏÑú ÏÑ§Ï†ï Î°úÎìú
      useEffect(() => {
        // Í∏∞Î≥∏Í∞íÏúºÎ°ú Î∞îÎ°ú ÏãúÏûë (Apps Script Î°úÎî© Ïä§ÌÇµ)
        setLoading(false);
        
        // Î∞±Í∑∏ÎùºÏö¥ÎìúÏóêÏÑú Î°úÎìú ÏãúÎèÑ (Ïã§Ìå®Ìï¥ÎèÑ Î¨¥Ïãú)
        loadConfigFromSheet();
      }, []);

      const loadConfigFromSheet = async () => {
        // ÏùºÎã® Í∏∞Î≥∏Í∞íÏúºÎ°ú Î∞îÎ°ú ÏãúÏûë
        setLoading(false);
        
        // Î∞±Í∑∏ÎùºÏö¥ÎìúÏóêÏÑú ÏãúÌä∏ Î°úÎî© ÏãúÎèÑ
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwgzP-H1Gih90FzF-hncsrXWf18LzFvmPA1CA3j7d8A7z_HDGuCQslJv_QKcGIJh_Cy/exec';
        
        if (APPS_SCRIPT_URL === 'YOUR_APPS_SCRIPT_URL_HERE') {
          setConfigError('‚ö†Ô∏è Apps Script URLÏùÑ ÏÑ§Ï†ïÌï¥Ï£ºÏÑ∏Ïöî');
          return;
        }

        try {
          // JSONP Î∞©ÏãùÏúºÎ°ú CORS Ïö∞Ìöå
          const callbackName = 'jsonpCallback_' + Date.now();
          
          await new Promise((resolve, reject) => {
            const timeout = setTimeout(() => {
              reject(new Error('Timeout'));
            }, 3000);
            
            window[callbackName] = (data) => {
              clearTimeout(timeout);
              delete window[callbackName];
              
              if (data.success && data.config) {
                const config = data.config;
                
                // ÏÇ¨Îûå Ï†ïÎ≥¥ Î≥ÄÌôò
                if (config.people && config.people.length > 0) {
                  const newPresets = {};
                  config.people.forEach(person => {
                    newPresets[person.name] = {
                      name: person.name,
                      reviewName: person.name.charAt(0) + '*' + person.name.charAt(person.name.length - 1),
                      phone: person.phone,
                      address: person.address,
                      coupangId: person.coupangId,
                      naverId: person.naverId,
                      bank: "Ïã†ÌïúÏùÄÌñâ",
                      account: "110254150254",
                      accountWithHyphen: "110254-150254"
                    };
                  });
                  setPRESETS(newPresets);
                  
                  const ids = config.people.map(p => p.coupangId).filter(Boolean);
                  if (ids.length > 0) setIDS(ids);
                }
                
                if (config.sites && config.sites.length > 0) setSITES(config.sites);
                if (config.siteIds) {
                  setSITE_IDS(config.siteIds);
                  console.log('‚úÖ ÏÇ¨Ïù¥Ìä∏Î≥Ñ ÏïÑÏù¥Îîî Î°úÎìúÎê®:', config.siteIds);
                }
                if (config.cards && config.cards.length > 0) setCARDS(config.cards);
                if (config.deliveryTypes && config.deliveryTypes.length > 0) setDELIVERY_TYPES(config.deliveryTypes);
                if (config.reviewMethods && config.reviewMethods.length > 0) setREVIEW_METHODS(config.reviewMethods);
                if (config.reviewFees && config.reviewFees.length > 0) setREVIEW_FEES(config.reviewFees.map(String));
                
                if (config.labelMappings && Object.keys(config.labelMappings).length > 0) {
                  setLearnedMappings(config.labelMappings);
                  console.log('‚úÖ ÎùºÎ≤® ÌïôÏäµ Îç∞Ïù¥ÌÑ∞ Î°úÎìúÎê®:', config.labelMappings);
                }
                
                setConfigError(''); // ÏóêÎü¨ Î©îÏãúÏßÄ Ï†úÍ±∞
                resolve();
              } else {
                reject(new Error(data.error || 'ÏÑ§Ï†ïÏùÑ Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§'));
              }
            };
            
            const script = document.createElement('script');
            script.src = APPS_SCRIPT_URL + '?action=getConfig&callback=' + callbackName;
            script.onerror = () => {
              clearTimeout(timeout);
              reject(new Error('Script load failed'));
            };
            document.body.appendChild(script);
            
            setTimeout(() => {
              if (document.body.contains(script)) {
                document.body.removeChild(script);
              }
            }, 5000);
          });
          
        } catch (error) {
          console.log('ÏÑ§Ï†ï Î°úÎî© Ïã§Ìå® (Í∏∞Î≥∏Í∞í ÏÇ¨Ïö©):', error);
          // ÏóêÎü¨ Î©îÏãúÏßÄ ÌëúÏãú Ïïà Ìï®
        }
      };

    // Î≤îÏö© ÌååÏã± Ìï®Ïàò
    const parseOrderText = (text) => {
      const result = {
        site: '',
        orderNumber: '',
        price: '',
        receiver: '',
        phone: '',
        address: '',
        detected: false
      };

      // ÏÇ¨Ïù¥Ìä∏ Í∞êÏßÄ (Îã§ÏñëÌïú ÌÇ§ÏõåÎìú)
      const siteKeywords = {
        "Ïø†Ìå°": ["Ïø†Ìå°", "coupang"],
        "ÎÑ§Ïù¥Î≤Ñ": ["ÎÑ§Ïù¥Î≤ÑÌéòÏù¥", "ÎÑ§Ïù¥Î≤ÑÌååÏù¥ÎÇ∏ÏÖú", "ÎÑ§Ïù¥Î≤Ñ"],
        "Ïò•ÏÖò": ["Ïò•ÏÖò", "auction", "eBay"],
        "ÏßÄÎßàÏºì": ["ÏßÄÎßàÏºì", "GÎßàÏºì", "gmarket"],
        "11Î≤àÍ∞Ä": ["11Î≤àÍ∞Ä", "11st"],
        "SSG": ["SSG", "Ïã†ÏÑ∏Í≥Ñ"],
        "Î¨¥Ïã†ÏÇ¨": ["Î¨¥Ïã†ÏÇ¨", "musinsa"],
        "Ïø†Ìå°": ["MYÏø†Ìå°", "ÎßàÏù¥Ïø†Ìå°"]
      };

      for (const [site, keywords] of Object.entries(siteKeywords)) {
        if (keywords.some(kw => text.includes(kw))) {
          result.site = site;
          break;
        }
      }

      // Ï£ºÎ¨∏Î≤àÌò∏ Ï∂îÏ∂ú (Îã§ÏñëÌïú Ìå®ÌÑ¥)
      const orderPatterns = [
        /Ï£ºÎ¨∏Î≤àÌò∏\s*(\d{10,})/i,              // Ïø†Ìå°: "Ï£ºÎ¨∏Î≤àÌò∏ 21100171701760"
        /Ï£ºÎ¨∏\s*Î≤àÌò∏[:\s]*(\d{10,})/i,
        /order[:\s]*(?:no|number)[:\s]*(\d{10,})/i,
        /Î≤àÌò∏[:\s]*(\d{10,})/i,
        /(\d{14,20})/                         // 14-20ÏûêÎ¶¨ Ïà´Ïûê (Ïø†Ìå° Ï£ºÎ¨∏Î≤àÌò∏)
      ];

      for (const pattern of orderPatterns) {
        const match = text.match(pattern);
        if (match && match[1]) {
          result.orderNumber = match[1];
          break;
        }
      }

      // Í∏àÏï° Ï∂îÏ∂ú
      const pricePatterns = [
        // ÎÑ§Ïù¥Î≤ÑÌéòÏù¥ Ïö∞ÏÑ†: Ïπ¥Îìú Í∞ÑÌé∏Í≤∞Ï†ú / Ïã†Ïö©Ïπ¥Îìú Îí§Ïùò Í∏àÏï°
        /(?:Ïπ¥Îìú\s*Í∞ÑÌé∏Í≤∞Ï†ú|Ïã†Ïö©Ïπ¥Îìú|Ï≤¥ÌÅ¨Ïπ¥Îìú)\s*\n\s*(\d{1,3}(?:,\d{3})*)\s*Ïõê/i,
        /(?:Ïπ¥Îìú\s*Í∞ÑÌé∏Í≤∞Ï†ú|Ïã†Ïö©Ïπ¥Îìú|Ï≤¥ÌÅ¨Ïπ¥Îìú)[^\d]*(\d{1,3}(?:,\d{3})*)\s*Ïõê/i,
        
        // Í≥ÑÏ¢åÏù¥Ï≤¥
        /(?:Í≥ÑÏ¢åÏù¥Ï≤¥|Î¨¥ÌÜµÏû•ÏûÖÍ∏à)\s*\n\s*(\d{1,3}(?:,\d{3})*)\s*Ïõê/i,
        
        // ÎÑ§Ïù¥Î≤ÑÌéòÏù¥: Ï£ºÎ¨∏Í∏àÏï° ÏÑπÏÖò
        /Ï£ºÎ¨∏Í∏àÏï°[^\d]*Ï¥ù\s*(\d{1,3}(?:,\d{3})*)\s*Ïõê/i,
        
        // ÏùºÎ∞ò Ìå®ÌÑ¥
        /Ï¥ù\s*Í≤∞Ï†ú\s*Í∏àÏï°[:\s]*(\d{1,3}(?:,\d{3})*)\s*Ïõê/i,
        /ÏµúÏ¢Ö\s*Í≤∞Ï†ú\s*Í∏àÏï°[:\s]*(\d{1,3}(?:,\d{3})*)/i,
        /total[:\s]*(\d{1,3}(?:,\d{3})*)/i,
        /Í≤∞Ï†ú\s*Í∏àÏï°[:\s]*(\d{1,3}(?:,\d{3})*)/i
      ];

      for (const pattern of pricePatterns) {
        const match = text.match(pattern);
        if (match && match[1]) {
          result.price = match[1].replace(/,/g, '');
          break;
        }
      }

      // ÏàòÏ∑®Ïù∏ Ï∂îÏ∂ú
      const receiverPatterns = [
        /Î∞õÎäîÏÇ¨Îûå\s*([^\s\t\n]+)/i,           // Ïø†Ìå°: "Î∞õÎäîÏÇ¨Îûå	Ï†ïÎèôÏã†"
        /Î∞õÎäî\s*ÏÇ¨Îûå[:\s]*([^\s\t\n]+)/i,     // "Î∞õÎäî ÏÇ¨Îûå: Ïù¥Ìï¥Ïö¥"
        /ÏàòÏ∑®Ïù∏[:\s]*([^\s\t\n]+)/i,
        /ÏàòÎ†πÏûê[:\s]*([^\s\t\n]+)/i,
        /Î∞õÏúºÏãúÎäî\s*Î∂Ñ[:\s]*([^\s\t\n]+)/i,
        /Î∞∞ÏÜ°ÏßÄÎ™Ö[^\(]*\(([^\)]+)\)/i
      ];

      for (const pattern of receiverPatterns) {
        const match = text.match(pattern);
        if (match && match[1]) {
          result.receiver = match[1].trim();
          break;
        }
      }

      // Ï†ÑÌôîÎ≤àÌò∏ Ï∂îÏ∂ú
      const phonePatterns = [
        /Ïó∞ÎùΩÏ≤ò\s*(010[-\s]?\d{4}[-\s]?\d{4})/i,  // Ïø†Ìå°: "Ïó∞ÎùΩÏ≤ò	010-9083-9985"
        /(010[-\s]?\d{4}[-\s]?\d{4})/
      ];
      for (const pattern of phonePatterns) {
        const phoneMatch = text.match(pattern);
        if (phoneMatch) {
          result.phone = phoneMatch[1].replace(/\s/g, '').replace(/(\d{3})(\d{4})(\d{4})/, '$1-$2-$3');
          break;
        }
      }

      // Ï£ºÏÜå Ï∂îÏ∂ú
      const addressPatterns = [
        /Î∞õÎäîÏ£ºÏÜå\s*\((\d{5})\)\s*([^\n]+)/i,     // Ïø†Ìå°: "Î∞õÎäîÏ£ºÏÜå	(10248) Í≤ΩÍ∏∞ÎèÑ..."
        /\((\d{5})\)\s*([^\n]+)/,
        /\[(\d{5})\]\s*([^\n]+)/,
        /Ï£ºÏÜå[:\s]*\(?\d{5}\)?\s*([^\n]+)/i,
        /Î∞õÎäî\s*Ï£ºÏÜå[:\s]*([^\n]+)/i
      ];

      for (const pattern of addressPatterns) {
        const match = text.match(pattern);
        if (match) {
          // Ï£ºÏÜåÏóêÏÑú Ïö∞Ìé∏Î≤àÌò∏, Î∞∞ÏÜ°ÏöîÏ≤≠ÏÇ¨Ìï≠ Îì± Ï†úÍ±∞
          let addr = match[match.length - 1].trim();
          // ÌÉ≠ Î¨∏Ïûê Ïù¥ÌõÑ ÎÇ¥Ïö© Ï†úÍ±∞ (Ïø†Ìå° Î∞∞ÏÜ°ÏöîÏ≤≠ÏÇ¨Ìï≠)
          addr = addr.split('\t')[0].trim();
          // Í¥ÑÌò∏ Ïïà ÏïÑÌååÌä∏Î™Ö Îì±ÏùÄ Ïú†ÏßÄ, Í∑∏ Ïù¥ÌõÑ Î∂àÌïÑÏöîÌïú ÎÇ¥Ïö© Ï†úÍ±∞
          result.address = addr;
          break;
        }
      }

      result.detected = !!(result.orderNumber || result.price);
      
      return result;
    };

      const [orders, setOrders] = useState([
        { 
          id: Date.now(), 
          rawText: '',
          site: '',
          orderNumber: '',
          price: '',
          person: Object.keys(PRESETS)[0],
          personId: PRESETS[Object.keys(PRESETS)[0]].coupangId,
          card: CARDS[0],
          deliveryType: 'Ïã§Î∞∞',
          reviewMethod: 'Ìè¨ÌÜ†',
          reviewFee: '1000',
          guideline: '',
          productUrl: '',
          parsed: false
        }
      ]);

      const [commonSettings, setCommonSettings] = useState({
        talkRoomName: '',
        transactionDate: new Date().toISOString().split('T')[0], // Ïò§Îäò ÎÇ†Ïßú (YYYY-MM-DD)
        deliveryType: 'Ïã§Î∞∞',
        reviewMethod: 'Ìè¨ÌÜ†',
        reviewFee: '1000',
        guideline: ''
      });

      const addOrder = () => {
        setOrders([...orders, {
          id: Date.now(),
          rawText: '',
          site: '',
          orderNumber: '',
          price: '',
          person: Object.keys(PRESETS)[orders.length % 6],
          personId: PRESETS[Object.keys(PRESETS)[orders.length % 6]].coupangId,
          card: CARDS[0],
          deliveryType: 'Ïã§Î∞∞',
          reviewMethod: 'Ìè¨ÌÜ†',
          reviewFee: '1000',
          guideline: '',
          productUrl: '',
          parsed: false
        }]);
      };

      const removeOrder = (id) => {
        if (orders.length > 1) {
          setOrders(orders.filter(o => o.id !== id));
        }
      };

      const handlePaste = (index, text) => {
        const parsed = parseOrderText(text);
        const newOrders = [...orders];
        
        // ÌååÏã±Îêú Ïù¥Î¶ÑÏúºÎ°ú ÌîÑÎ¶¨ÏÖã ÏûêÎèô Îß§Ïπ≠
        let matchedPerson = newOrders[index].person;
        if (parsed.receiver) {
          // PRESETSÏóêÏÑú Ïù¥Î¶ÑÏù¥ ÏùºÏπòÌïòÎäî ÏÇ¨Îûå Ï∞æÍ∏∞
          const foundPerson = Object.keys(PRESETS).find(name => 
            name.includes(parsed.receiver) || parsed.receiver.includes(name)
          );
          if (foundPerson) {
            matchedPerson = foundPerson;
          }
        }
        
        newOrders[index] = {
          ...newOrders[index],
          rawText: text,
          site: parsed.site || newOrders[index].site,
          orderNumber: parsed.orderNumber || newOrders[index].orderNumber,
          price: parsed.price || newOrders[index].price,
          person: matchedPerson,  // ÏûêÎèô Îß§Ïπ≠Îêú ÏÇ¨Îûå
          personId: PRESETS[matchedPerson].coupangId,  // ÏïÑÏù¥ÎîîÎèÑ ÏûêÎèô ÏÑ§Ï†ï
          parsedReceiver: parsed.receiver,  // ÌååÏã±Îêú ÏõêÎ≥∏ Ïù¥Î¶Ñ Î≥¥Ï°¥
          parsedPhone: parsed.phone,        // ÌååÏã±Îêú Ï†ÑÌôîÎ≤àÌò∏ Î≥¥Ï°¥
          parsedAddress: parsed.address,    // ÌååÏã±Îêú Ï£ºÏÜå Î≥¥Ï°¥
          parsed: parsed.detected
        };
        setOrders(newOrders);
      };

      const updateOrder = (index, field, value) => {
        const newOrders = [...orders];
        newOrders[index][field] = value;
        if (field === 'person') {
          newOrders[index].personId = PRESETS[value].coupangId;
        }
        setOrders(newOrders);
      };

      const applyCommonSettings = () => {
        setOrders(orders.map(order => {
          const updatedOrder = {
            ...order,
            deliveryType: commonSettings.deliveryType,
            reviewMethod: commonSettings.reviewMethod,
            reviewFee: commonSettings.reviewFee,
            guideline: commonSettings.guideline
          };
          
          // Ï£ºÎ¨∏Ïûê ÏùºÍ¥Ñ Ï†ÅÏö© (ÏÑ†ÌÉùÎêú Í≤ΩÏö∞)
          if (commonSettings.person) {
            updatedOrder.person = commonSettings.person;
            updatedOrder.personId = PRESETS[commonSettings.person].coupangId;
          }
          
          // Î¶ΩÎπÑ ÏßÅÏ†ëÏûÖÎ†• Í∞í Ï†ÅÏö©
          if (commonSettings.reviewFee === 'ÏßÅÏ†ëÏûÖÎ†•' && commonSettings.customReviewFee) {
            updatedOrder.customFee = commonSettings.customReviewFee;
          }
          
          return updatedOrder;
        }));
        
        alert('‚úÖ Í≥µÌÜµ ÏÑ§Ï†ïÏù¥ Î™®Îì† Ï£ºÎ¨∏Ïóê Ï†ÅÏö©ÎêòÏóàÏäµÎãàÎã§!');
      };

      const resetAllOrders = () => {
        if (confirm('üóëÔ∏è Î™®Îì† Ï£ºÎ¨∏ÏùÑ ÏÇ≠Ï†úÌïòÍ≥† Ï¥àÍ∏∞ÌôîÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
          setOrders([{
            id: Date.now(),
            rawText: '',
            site: '',
            orderNumber: '',
            price: '',
            person: Object.keys(PRESETS)[0],
            personId: PRESETS[Object.keys(PRESETS)[0]].coupangId,
            card: CARDS[0],
            deliveryType: 'Ïã§Î∞∞',
            reviewMethod: 'Ìè¨ÌÜ†',
            reviewFee: '1000',
            guideline: '',
            productUrl: '',
            parsed: false
          }]);
          setCommonSettings({
            talkRoomName: '',
            transactionDate: new Date().toISOString().split('T')[0],
            deliveryType: 'Ïã§Î∞∞',
            reviewMethod: 'Ìè¨ÌÜ†',
            reviewFee: '1000',
            guideline: ''
          });
          alert('‚úÖ Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§!');
        }
      };

      // Ï∂úÎ†• ÏÑ§Ï†ï state
      const [formTemplate, setFormTemplate] = useState('');
      const [removeLabels, setRemoveLabels] = useState(false);
      const [selectedOrders, setSelectedOrders] = useState([]);
      const [outputData, setOutputData] = useState({});
      const [editableData, setEditableData] = useState({}); // Ìé∏Ïßë Í∞ÄÎä•Ìïú Îç∞Ïù¥ÌÑ∞

      // Ï£ºÎ¨∏ ÏÑ†ÌÉù Ïãú Ìé∏Ïßë Îç∞Ïù¥ÌÑ∞ Ï¥àÍ∏∞Ìôî
      useEffect(() => {
        const fields = parseFormTemplate(formTemplate);
        const newEditableData = {};
        
        selectedOrders.forEach(orderIndex => {
          const order = orders[orderIndex];
          if (!order) return;
          
          const preset = PRESETS[order.person];
          const site = order.site === 'ÏßÅÏ†ëÏûÖÎ†•' ? (order.customSite || '') : order.site;
          const personId = order.personId === 'ÏßÅÏ†ëÏûÖÎ†•' ? (order.customId || '') : order.personId;
          const reviewFee = order.reviewFee === 'ÏßÅÏ†ëÏûÖÎ†•' ? (order.customFee || '') : order.reviewFee;
          
          newEditableData[orderIndex] = {
            // Ï£ºÎ¨∏ÏÑú Îç∞Ïù¥ÌÑ∞ Ïö∞ÏÑ†, ÏóÜÏúºÎ©¥ ÌîÑÎ¶¨ÏÖã
            name: order.parsedReceiver || preset.name,
            receiver: order.parsedReceiver || preset.name,
            phone: order.parsedPhone || preset.phone,
            phoneNoHyphen: (order.parsedPhone || preset.phone).replace(/-/g, ''),
            address: order.parsedAddress || preset.address,
            
            // Ï£ºÎ¨∏ Ï†ïÎ≥¥
            orderNumber: order.orderNumber,
            personId: personId,
            price: order.price,
            site: site,
            
            // ÌîÑÎ¶¨ÏÖãÏóêÎßå ÏûàÎäî Ï†ïÎ≥¥
            naverId: preset.naverId,
            bank: preset.bank,
            account: preset.account,
            accountWithHyphen: preset.accountWithHyphen,
            
            // ÏÑ§Ï†ï
            card: order.card,
            deliveryType: order.deliveryType,
            reviewMethod: order.reviewMethod,
            reviewFee: reviewFee
          };
        });
        
        setEditableData(newEditableData);
      }, [selectedOrders, formTemplate, orders]);

      // Ìé∏Ïßë Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏
      const updateEditableData = (orderIndex, field, value) => {
        setEditableData({
          ...editableData,
          [orderIndex]: {
            ...editableData[orderIndex],
            [field]: value
          }
        });
      };

      // Ìèº ÏñëÏãù ÌååÏã±
      const parseFormTemplate = (template) => {
        const lines = template.split('\n').filter(l => l.trim());
        const fields = [];
        
        lines.forEach(line => {
          // "Ïù¥Î¶Ñ:", "Ï£ºÎ¨∏Î≤àÌò∏:" Í∞ôÏùÄ ÎùºÎ≤® Ï∂îÏ∂ú
          const match = line.match(/^([^:Ôºö/]+)[:\Ôºö]?\s*$/);
          if (match) {
            fields.push(match[1].trim());
          }
          // "Ïù¥Î¶Ñ / Ï†ÑÌôîÎ≤àÌò∏" Í∞ôÏùÄ Ïä¨ÎûòÏãú Íµ¨Î∂Ñ
          else if (line.includes('/')) {
            const parts = line.split('/').map(p => p.trim());
            fields.push(...parts);
          }
        });
        
        return fields;
      };

      // ÌïÑÎìúÎ™ÖÏùÑ Îç∞Ïù¥ÌÑ∞ ÌÇ§Î°ú Îß§Ìïë
      const [learnedMappings, setLearnedMappings] = useState(() => {
        const saved = localStorage.getItem('learnedMappings');
        return saved ? JSON.parse(saved) : {};
      });

      const mapFieldToKey = (fieldName) => {
        // Î®ºÏ†Ä ÌïôÏäµÎêú Îß§Ìïë ÌôïÏù∏
        if (learnedMappings[fieldName]) {
          return learnedMappings[fieldName];
        }
        
        const mappings = {
          'Ïù¥Î¶Ñ': 'name',
          'ÏÑ±Î™Ö': 'name',
          'Íµ¨Îß§Ïûê': 'name',
          'ÏÑ±Ìï®': 'name',
          'ÏàòÏ∑®Ïù∏': 'receiver',
          'Î∞õÎäîÎ∂Ñ': 'receiver',
          'Î∞õÎäîÏÇ¨Îûå': 'receiver',
          'Ï£ºÎ¨∏Î≤àÌò∏': 'orderNumber',
          'Î≤àÌò∏': 'orderNumber',
          'ÏïÑÏù¥Îîî': 'personId',
          'ID': 'personId',
          'Ïù¥Î©îÏùº': 'naverId',
          'Ï†ÑÌôîÎ≤àÌò∏': 'phone',
          'Ïó∞ÎùΩÏ≤ò': 'phone',
          'Ìï∏ÎìúÌè∞': 'phone',
          'Ï£ºÏÜå': 'address',
          'Î∞∞ÏÜ°ÏßÄ': 'address',
          'Í∏àÏï°': 'price',
          'Í∞ÄÍ≤©': 'price',
          'Í≤∞Ï†úÍ∏àÏï°': 'price',
          'ÏÇ¨Ïù¥Ìä∏': 'site',
          'Ï±ÑÎÑê': 'site',
          'Íµ¨Îß§Ï±ÑÎÑê': 'site',
          'Ïπ¥Îìú': 'card',
          'Î∞∞ÏÜ°': 'deliveryType',
          'Î¶¨Î∑∞': 'reviewMethod',
          'Î¶ΩÎπÑ': 'reviewFee',
          'ÏùÄÌñâ': 'bank',
          'ÏùÄÌñâÎ™Ö': 'bank',
          'Í≥ÑÏ¢å': 'accountWithHyphen',
          'Í≥ÑÏ¢åÎ≤àÌò∏': 'accountWithHyphen',
          'ÏùÄÌñâ Í≥ÑÏ¢åÎ≤àÌò∏': 'accountWithHyphen',
          'ÏòàÍ∏àÏ£º': 'name',
          'Íµ¨ÏûÖ Í∏àÏï°': 'price',
          'Íµ¨ÏûÖÍ∏àÏï°': 'price'
        };
        
        return mappings[fieldName] || fieldName;
      };

      // ÎùºÎ≤® ÌïôÏäµ Ï†ÄÏû•
      const saveLearnedMapping = (label, key) => {
        const newMappings = {
          ...learnedMappings,
          [label]: key
        };
        setLearnedMappings(newMappings);
        localStorage.setItem('learnedMappings', JSON.stringify(newMappings));
        alert(`‚úÖ "${label}" ‚Üí "${key}" Îß§ÌïëÏù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§!`);
      };

      // Ï£ºÎ¨∏ ÏÑ†ÌÉù ÌÜ†Í∏Ä
      const toggleOrderSelection = (index) => {
        if (selectedOrders.includes(index)) {
          setSelectedOrders(selectedOrders.filter(i => i !== index));
        } else {
          setSelectedOrders([...selectedOrders, index]);
        }
      };

      // Ï∂úÎ†• Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±
      const generateOutputText = () => {
        if (!formTemplate.trim()) {
          alert('‚ö†Ô∏è Ìèº ÏñëÏãùÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî');
          return '';
        }
        
        if (selectedOrders.length === 0) {
          alert('‚ö†Ô∏è Ï∂úÎ†•Ìï† Ï£ºÎ¨∏ÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî');
          return '';
        }
        
        return selectedOrders.map(orderIndex => {
          const data = editableData[orderIndex];
          if (!data) return '';
          
          const lines = formTemplate.split('\n').filter(l => l.trim());
          
          return lines.map(line => {
            // Ïä¨ÎûòÏãú ÌòïÏãù Ï≤¥ÌÅ¨ ‚Üí Î¨¥Ï°∞Í±¥ ÎùºÎ≤® ÏóÜÏù¥ Ï∂úÎ†•
            if (line.includes('/')) {
              const parts = line.split('/');
              const values = parts.map(part => {
                const fieldName = part.trim();
                const key = mapFieldToKey(fieldName);
                return data[key] || '';
              });
              
              // Ïä¨ÎûòÏãú ÏïûÎí§ Í≥µÎ∞± Ïú†ÏßÄ
              const separator = line.match(/\s*\/\s*/)?.[0] || '/';
              
              // Ïä¨ÎûòÏãú ÌòïÏãùÏùÄ Ìï≠ÏÉÅ ÎùºÎ≤® ÏóÜÏù¥ Í∞íÎßå Ï∂úÎ†•
              return values.join(separator);
            }
            // ÏùºÎ∞ò ÎùºÎ≤® ÌòïÏãù
            else {
              const match = line.match(/^([^:Ôºö]+)[:\Ôºö]?\s*$/);
              if (match) {
                const fieldName = match[1].trim();
                const key = mapFieldToKey(fieldName);
                const value = data[key] || '';
                
                if (removeLabels) {
                  return value;
                } else {
                  return `${fieldName}: ${value}`;
                }
              }
            }
            return '';
          }).filter(Boolean).join('\n');
        }).filter(Boolean).join('\n\n---\n\n');
      };

      const copyOutputToClipboard = () => {
        const text = generateOutputText();
        if (text) {
          navigator.clipboard.writeText(text);
          alert(`‚úÖ ${selectedOrders.length}Í∞ú Ï£ºÎ¨∏Ïù¥ Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§!`);
        }
      };

      const [outputSettings, setOutputSettings] = useState({
        format: 'form',
        customTemplate: '',
        separator: '/',
        phoneFormat: 'hyphen', // 'hyphen' or 'none'
        accountFormat: 'hyphen' // 'hyphen' or 'none'
      });

      const [savedPresets, setSavedPresets] = useState(() => {
        const saved = localStorage.getItem('outputPresets');
        return saved ? JSON.parse(saved) : {
          "Í∏∞Î≥∏": {
            separator: '/',
            phoneFormat: 'hyphen',
            accountFormat: 'hyphen',
            customTemplate: ''
          }
        };
      });

      const [presetName, setPresetName] = useState('');
      const [showPresetDialog, setShowPresetDialog] = useState(false);

      const savePreset = () => {
        if (!presetName.trim()) {
          alert('‚ö†Ô∏è ÌîÑÎ¶¨ÏÖã Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî');
          return;
        }
        
        const newPresets = {
          ...savedPresets,
          [presetName]: {
            separator: outputSettings.separator,
            phoneFormat: outputSettings.phoneFormat,
            accountFormat: outputSettings.accountFormat,
            customTemplate: outputSettings.customTemplate
          }
        };
        
        setSavedPresets(newPresets);
        localStorage.setItem('outputPresets', JSON.stringify(newPresets));
        setPresetName('');
        setShowPresetDialog(false);
        alert(`‚úÖ "${presetName}" ÌîÑÎ¶¨ÏÖãÏù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§!`);
      };

      const loadPreset = (name) => {
        const preset = savedPresets[name];
        if (preset) {
          setOutputSettings({
            ...outputSettings,
            separator: preset.separator,
            phoneFormat: preset.phoneFormat,
            accountFormat: preset.accountFormat,
            customTemplate: preset.customTemplate
          });
          alert(`‚úÖ "${name}" ÌîÑÎ¶¨ÏÖãÏùÑ Î∂àÎü¨ÏôîÏäµÎãàÎã§!`);
        }
      };

      const deletePreset = (name) => {
        if (name === 'Í∏∞Î≥∏') {
          alert('‚ö†Ô∏è Í∏∞Î≥∏ ÌîÑÎ¶¨ÏÖãÏùÄ ÏÇ≠Ï†úÌï† Ïàò ÏóÜÏäµÎãàÎã§');
          return;
        }
        
        if (confirm(`"${name}" ÌîÑÎ¶¨ÏÖãÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?`)) {
          const newPresets = {...savedPresets};
          delete newPresets[name];
          setSavedPresets(newPresets);
          localStorage.setItem('outputPresets', JSON.stringify(newPresets));
          alert(`‚úÖ "${name}" ÌîÑÎ¶¨ÏÖãÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§`);
        }
      };

      const generateOutput = (format = 'form', customTemplate = '') => {
        return orders.filter(o => o.orderNumber && o.price).map(order => {
          const preset = PRESETS[order.person];
          
          // ÏßÅÏ†ëÏûÖÎ†• Í∞í Ï≤òÎ¶¨
          const site = order.site === 'ÏßÅÏ†ëÏûÖÎ†•' ? (order.customSite || 'ÏßÅÏ†ëÏûÖÎ†•') : order.site;
          const personId = order.personId === 'ÏßÅÏ†ëÏûÖÎ†•' ? (order.customId || 'ÏßÅÏ†ëÏûÖÎ†•') : order.personId;
          const reviewFee = order.reviewFee === 'ÏßÅÏ†ëÏûÖÎ†•' ? (order.customFee || 'ÏßÅÏ†ëÏûÖÎ†•') : order.reviewFee;
          
          // Ï†ÑÌôîÎ≤àÌò∏ Ìè¨Îß∑
          const phone = outputSettings.phoneFormat === 'none' 
            ? preset.phone.replace(/-/g, '') 
            : preset.phone;
          
          // Í≥ÑÏ¢åÎ≤àÌò∏ Ìè¨Îß∑  
          const account = outputSettings.accountFormat === 'none'
            ? preset.account
            : preset.accountWithHyphen;
          
          if (format === 'slash') {
            const sep = ` ${outputSettings.separator} `;
            return `${preset.name}${sep}${preset.name}${sep}${personId}${sep}${phone}${sep}${preset.address}${sep}${preset.bank}${sep}${account}${sep}${preset.name}${sep}${order.price}`;
          } else if (format === 'form') {
            return `Íµ¨ÏûÖ Ï±ÑÎÑê: ${site}
ÏïÑÏù¥Îîî: ${personId}
Ï£ºÎ¨∏Î≤àÌò∏: ${order.orderNumber}
Íµ¨Îß§ÏûêÎ™Ö: ${preset.name}
ÏàòÏ∑®Ïù∏Î™Ö: ${preset.name}
Ï£ºÏÜå: ${preset.address}
Ïó∞ÎùΩÏ≤ò(-Ìè¨Ìï®): ${phone}
ÏùÄÌñâÎ™Ö: ${preset.bank}
ÏùÄÌñâ Í≥ÑÏ¢åÎ≤àÌò∏(ÌïòÏù¥ÌîàÏÇ≠Ï†ú -): ${preset.account}
ÏùÄÌñâ ÏòàÍ∏àÏ£º: ${preset.name}
Í≤∞Ï†ú Í∏àÏï°: ${order.price}`;
          } else if (format === 'custom' && customTemplate) {
            // Ïª§Ïä§ÌÖÄ ÌÖúÌîåÎ¶ø ÏÇ¨Ïö©
            return customTemplate
              .replace(/{site}/g, site)
              .replace(/{id}/g, personId)
              .replace(/{orderNumber}/g, order.orderNumber)
              .replace(/{name}/g, preset.name)
              .replace(/{receiver}/g, preset.name)
              .replace(/{phone}/g, phone)
              .replace(/{address}/g, preset.address)
              .replace(/{bank}/g, preset.bank)
              .replace(/{account}/g, account)
              .replace(/{accountHolder}/g, preset.name)
              .replace(/{price}/g, order.price)
              .replace(/{card}/g, order.card)
              .replace(/{delivery}/g, order.deliveryType)
              .replace(/{review}/g, order.reviewMethod)
              .replace(/{reviewFee}/g, reviewFee);
          } else {
            // Í∞íÎßå
            return `${site}
${personId}
${order.orderNumber}
${preset.name}
${preset.name}
${preset.address}
${phone}
${preset.bank}
${preset.account}
${preset.name}
${order.price}`;
          }
        }).join('\n\n---\n\n');
      };

      const copyToClipboard = (format) => {
        const text = generateOutput(format, outputSettings.customTemplate);
        if (!text) {
          alert('‚ö†Ô∏è Î≥µÏÇ¨Ìï† Ï£ºÎ¨∏Ïù¥ ÏóÜÏäµÎãàÎã§.\nÏ£ºÎ¨∏Î≤àÌò∏ÏôÄ Í∏àÏï°Ïù¥ ÏûàÎäî Ï£ºÎ¨∏Îßå Î≥µÏÇ¨Îê©ÎãàÎã§.');
          return;
        }
        navigator.clipboard.writeText(text);
        alert(`‚úÖ ${orders.filter(o => o.orderNumber && o.price).length}Í∞ú Ï£ºÎ¨∏Ïù¥ Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§!`);
      };

      const saveToGoogleSheets = async () => {
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwgzP-H1Gih90FzF-hncsrXWf18LzFvmPA1CA3j7d8A7z_HDGuCQslJv_QKcGIJh_Cy/exec';
        
        if (APPS_SCRIPT_URL === 'YOUR_APPS_SCRIPT_URL_HERE') {
          alert('‚ö†Ô∏è Apps Script URLÏùÑ ÏÑ§Ï†ïÌï¥Ï£ºÏÑ∏Ïöî!\n\nÌååÏùºÏùÑ ÌÖçÏä§Ìä∏ ÏóêÎîîÌÑ∞Î°ú Ïó¥Ïñ¥ÏÑú\nYOUR_APPS_SCRIPT_URL_HEREÎ•º\nÏã§Ï†ú URLÎ°ú ÍµêÏ≤¥ÌïòÏÑ∏Ïöî.');
          return;
        }

        const sheetsData = orders.filter(o => o.orderNumber && o.price).map(order => {
          // Í≥µÌÜµ ÏÑ§Ï†ïÏóêÏÑú ÏÑ†ÌÉùÌïú ÎÇ†Ïßú ÏÇ¨Ïö©
          const selectedDate = new Date(commonSettings.transactionDate);
          const dateStr = `${selectedDate.getFullYear()}. ${selectedDate.getMonth() + 1}. ${selectedDate.getDate()}`;
          
          // ÏßÅÏ†ëÏûÖÎ†• Í∞í Ï≤òÎ¶¨
          const site = order.site === 'ÏßÅÏ†ëÏûÖÎ†•' ? (order.customSite || 'ÏßÅÏ†ëÏûÖÎ†•') : order.site;
          const personId = order.personId === 'ÏßÅÏ†ëÏûÖÎ†•' ? (order.customId || 'ÏßÅÏ†ëÏûÖÎ†•') : order.personId;
          const reviewFee = order.reviewFee === 'ÏßÅÏ†ëÏûÖÎ†•' ? (order.customFee || 'ÏßÅÏ†ëÏûÖÎ†•') : order.reviewFee;
          
          return {
            date: dateStr,
            site: site,
            talkRoom: commonSettings.talkRoomName,
            id: personId,
            price: order.price,
            card: order.card,
            delivery: order.deliveryType,
            review: order.reviewMethod,
            reviewFee: reviewFee,
            guideline: order.guideline,
            orderNumber: order.orderNumber,
            productUrl: order.productUrl || ''
          };
        });

        if (sheetsData.length === 0) {
          alert('‚ö†Ô∏è Ï†ÄÏû•Ìï† Ï£ºÎ¨∏Ïù¥ ÏóÜÏäµÎãàÎã§.\nÏ£ºÎ¨∏Î≤àÌò∏ÏôÄ Í∏àÏï°Ïù¥ ÏûàÎäî Ï£ºÎ¨∏Îßå Ï†ÄÏû•Îê©ÎãàÎã§.');
          return;
        }

        try {
          await fetch(APPS_SCRIPT_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ orders: sheetsData }),
            mode: 'no-cors'
          });
          
          alert(`‚úÖ ${sheetsData.length}Í∞ú Ï£ºÎ¨∏Ïù¥ Íµ¨Í∏Ä ÏãúÌä∏Ïóê Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§!`);
          
        } catch (error) {
          console.error('Ï†ÄÏû• Ïò§Î•ò:', error);
          alert('‚ùå Ï†ÄÏû• Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.\n\n' + error.message);
        }
      };

      // Î°úÎî© Ï§ëÏù¥Î©¥ Î°úÎî© ÌôîÎ©¥ ÌëúÏãú
      if (loading) {
        return React.createElement('div', {
          style: {
            minHeight: '100vh',
            background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
            display: 'flex',
            justifyContent: 'center',
            alignItems: 'center',
            fontFamily: '"Pretendard", -apple-system, BlinkMacSystemFont, system-ui, sans-serif'
          }
        },
          React.createElement('div', {
            style: {
              background: 'white',
              padding: '3rem',
              borderRadius: '16px',
              textAlign: 'center',
              boxShadow: '0 20px 60px rgba(0, 0, 0, 0.3)'
            }
          },
            React.createElement('div', {
              style: {
                fontSize: '3rem',
                marginBottom: '1rem'
              }
            }, 'üì¶'),
            React.createElement('h2', {
              style: {
                margin: '0 0 0.5rem 0',
                fontSize: '1.5rem',
                color: '#2d3748'
              }
            }, 'ÏÑ§Ï†ï Î°úÎî© Ï§ë...'),
            React.createElement('p', {
              style: {
                margin: 0,
                color: '#64748b',
                fontSize: '0.95rem'
              }
            }, 'review-setting ÏãúÌä∏ÏóêÏÑú Ï†ïÎ≥¥Î•º Í∞ÄÏ†∏Ïò§Í≥† ÏûàÏäµÎãàÎã§.')
          )
        );
      }

      return React.createElement('div', {
        style: {
          minHeight: '100vh',
          background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
          padding: '2rem',
          fontFamily: '"Pretendard", -apple-system, BlinkMacSystemFont, system-ui, sans-serif'
        }
      },
        React.createElement('div', {
          style: {
            maxWidth: '1400px',
            margin: '0 auto',
            background: 'rgba(255, 255, 255, 0.95)',
            borderRadius: '24px',
            boxShadow: '0 20px 60px rgba(0, 0, 0, 0.3)',
            overflow: 'hidden'
          }
        },
          // Header
          React.createElement('div', {
            style: {
              background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
              padding: '2rem',
              color: 'white'
            }
          },
            React.createElement('h1', {
              style: {
                margin: 0,
                fontSize: '2rem',
                fontWeight: '700',
                letterSpacing: '-0.5px'
              }
            }, 'üì¶ Ï£ºÎ¨∏ Í¥ÄÎ¶¨ ÏãúÏä§ÌÖú'),
            React.createElement('p', {
              style: {
                margin: '0.5rem 0 0 0',
                opacity: 0.9,
                fontSize: '0.95rem'
              }
            }, 'Î™®Îì† ÏáºÌïëÎ™∞ ÏßÄÏõê | ÏûêÎèô ÌååÏã± + ÏàòÎèô ÏàòÏ†ï')
          ),

          React.createElement('div', { style: { padding: '2rem' } },
            // ÏóêÎü¨ Î©îÏãúÏßÄ
            configError && React.createElement('div', {
              style: {
                background: '#fef2f2',
                border: '1px solid #fca5a5',
                borderRadius: '8px',
                padding: '1rem',
                marginBottom: '1.5rem',
                color: '#991b1b',
                fontSize: '0.9rem'
              }
            }, configError),

            // Ï£ºÎ¨∏ ÏûÖÎ†• ÏòÅÏó≠
            React.createElement('div', {
              style: {
                display: 'flex',
                justifyContent: 'space-between',
                alignItems: 'center',
                marginBottom: '1.5rem'
              }
            },
              React.createElement('h2', {
                style: {
                  fontSize: '1.3rem',
                  fontWeight: '600',
                  margin: 0,
                  color: '#2d3748'
                }
              }, `üìã Ï£ºÎ¨∏ ÏûÖÎ†• (${orders.length}Í∞ú)`),
              React.createElement('button', {
                onClick: addOrder,
                style: {
                  background: '#10b981',
                  color: 'white',
                  border: 'none',
                  padding: '0.75rem 1.5rem',
                  borderRadius: '8px',
                  fontSize: '0.95rem',
                  fontWeight: '600',
                  cursor: 'pointer',
                  display: 'flex',
                  alignItems: 'center',
                  gap: '0.5rem'
                }
              }, '‚ûï Ï£ºÎ¨∏ Ï∂îÍ∞Ä')
            ),

            // Ï£ºÎ¨∏ Î™©Î°ù
            orders.map((order, index) => (
              React.createElement('div', {
                key: order.id,
                style: {
                  background: '#f8fafc',
                  border: order.parsed ? '2px solid #10b981' : '2px solid #e2e8f0',
                  borderRadius: '12px',
                  padding: '1.5rem',
                  marginBottom: '1.5rem'
                }
              },
                // Ìó§Îçî
                React.createElement('div', {
                  style: {
                    display: 'flex',
                    justifyContent: 'space-between',
                    alignItems: 'center',
                    marginBottom: '1rem'
                  }
                },
                  React.createElement('h3', {
                    style: {
                      fontSize: '1.1rem',
                      fontWeight: '600',
                      color: '#1e293b',
                      margin: 0
                    }
                  }, `Ï£ºÎ¨∏ ${index + 1}`),
                  orders.length > 1 && React.createElement('button', {
                    onClick: () => removeOrder(order.id),
                    style: {
                      background: '#ef4444',
                      color: 'white',
                      border: 'none',
                      padding: '0.5rem 1rem',
                      borderRadius: '6px',
                      fontSize: '0.85rem',
                      cursor: 'pointer'
                    }
                  }, '‚ùå ÏÇ≠Ï†ú')
                ),

                // ÌÖçÏä§Ìä∏ ÏûÖÎ†•
                React.createElement('div', { style: { marginBottom: '1rem' } },
                  React.createElement('label', {
                    style: {
                      display: 'block',
                      fontSize: '0.85rem',
                      fontWeight: '500',
                      color: '#475569',
                      marginBottom: '0.5rem'
                    }
                  }, 'Ï£ºÎ¨∏ Ï†ïÎ≥¥ Î∂ôÏó¨ÎÑ£Í∏∞'),
                  React.createElement('textarea', {
                    value: order.rawText,
                    onChange: (e) => handlePaste(index, e.target.value),
                    placeholder: 'Ïø†Ìå°, ÎÑ§Ïù¥Î≤Ñ, Ïò•ÏÖò Îì± Ï£ºÎ¨∏ ÌéòÏù¥ÏßÄÏóêÏÑú Î≥µÏÇ¨Ìïú ÎÇ¥Ïö©ÏùÑ Î∂ôÏó¨ÎÑ£ÏúºÏÑ∏Ïöî...',
                    style: {
                      width: '100%',
                      minHeight: '100px',
                      padding: '0.75rem',
                      border: '1px solid #cbd5e1',
                      borderRadius: '8px',
                      fontSize: '0.9rem',
                      fontFamily: 'inherit',
                      resize: 'vertical'
                    }
                  })
                ),

                // ÌååÏã± Í≤∞Í≥º
                order.parsed && React.createElement('div', {
                  style: {
                    background: '#f0fdf4',
                    border: '1px solid #86efac',
                    borderRadius: '8px',
                    padding: '0.75rem',
                    marginBottom: '1rem',
                    fontSize: '0.85rem',
                    color: '#166534'
                  }
                }, `‚úì ${order.site || 'ÏÇ¨Ïù¥Ìä∏'} Í∞êÏßÄÎê® | Ï£ºÎ¨∏Î≤àÌò∏: ${order.orderNumber.slice(0, 10)}... | Í∏àÏï°: ${parseInt(order.price || 0).toLocaleString()}Ïõê`),

                // ÏàòÎèô ÏûÖÎ†•/ÏàòÏ†ï Ìèº
                React.createElement('div', {
                  style: {
                    background: 'white',
                    border: '1px solid #e2e8f0',
                    borderRadius: '8px',
                    padding: '1rem',
                    marginBottom: '1rem'
                  }
                },
                  React.createElement('div', {
                    style: {
                      fontSize: '0.9rem',
                      fontWeight: '600',
                      color: '#64748b',
                      marginBottom: '1rem'
                    }
                  }, 'üìù Ï£ºÎ¨∏ Ï†ïÎ≥¥ ÌôïÏù∏/ÏàòÏ†ï'),

                  React.createElement('div', {
                    style: {
                      display: 'grid',
                      gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',
                      gap: '1rem'
                    }
                  },
                    // ÏÇ¨Ïù¥Ìä∏
                    React.createElement('div', null,
                      React.createElement('label', {
                        style: {
                          display: 'block',
                          fontSize: '0.8rem',
                          fontWeight: '500',
                          color: '#475569',
                          marginBottom: '0.5rem'
                        }
                      }, 'ÏÇ¨Ïù¥Ìä∏'),
                      React.createElement('select', {
                        value: order.site,
                        onChange: (e) => updateOrder(index, 'site', e.target.value),
                        style: {
                          width: '100%',
                          padding: '0.5rem',
                          border: '1px solid #cbd5e1',
                          borderRadius: '6px',
                          fontSize: '0.9rem'
                        }
                      }, 
                        React.createElement('option', { value: '' }, 'ÏÑ†ÌÉù'),
                        SITES.map(site => React.createElement('option', { key: site, value: site }, site))
                      )
                    ),

                    // ÏÇ¨Ïù¥Ìä∏ ÏßÅÏ†ëÏûÖÎ†• Ïπ∏
                    order.site === 'ÏßÅÏ†ëÏûÖÎ†•' && React.createElement('div', null,
                      React.createElement('label', {
                        style: {
                          display: 'block',
                          fontSize: '0.8rem',
                          fontWeight: '500',
                          color: '#475569',
                          marginBottom: '0.5rem'
                        }
                      }, 'ÏÇ¨Ïù¥Ìä∏Î™Ö ÏûÖÎ†•'),
                      React.createElement('input', {
                        type: 'text',
                        value: order.customSite || '',
                        onChange: (e) => updateOrder(index, 'customSite', e.target.value),
                        placeholder: 'ÏÇ¨Ïù¥Ìä∏Î™ÖÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî',
                        style: {
                          width: '100%',
                          padding: '0.5rem',
                          border: '2px solid #3b82f6',
                          borderRadius: '6px',
                          fontSize: '0.9rem'
                        }
                      })
                    ),

                    // Ï£ºÎ¨∏Î≤àÌò∏
                    React.createElement('div', null,
                      React.createElement('label', {
                        style: {
                          display: 'block',
                          fontSize: '0.8rem',
                          fontWeight: '500',
                          color: '#475569',
                          marginBottom: '0.5rem'
                        }
                      }, 'Ï£ºÎ¨∏Î≤àÌò∏'),
                      React.createElement('input', {
                        type: 'text',
                        value: order.orderNumber,
                        onChange: (e) => updateOrder(index, 'orderNumber', e.target.value),
                        placeholder: 'ÏßÅÏ†ë ÏûÖÎ†•',
                        style: {
                          width: '100%',
                          padding: '0.5rem',
                          border: '1px solid #cbd5e1',
                          borderRadius: '6px',
                          fontSize: '0.9rem',
                          fontFamily: 'monospace'
                        }
                      })
                    ),

                    // Í∏àÏï°
                    React.createElement('div', null,
                      React.createElement('label', {
                        style: {
                          display: 'block',
                          fontSize: '0.8rem',
                          fontWeight: '500',
                          color: '#475569',
                          marginBottom: '0.5rem'
                        }
                      }, 'Í∏àÏï°'),
                      React.createElement('input', {
                        type: 'text',
                        value: order.price,
                        onChange: (e) => updateOrder(index, 'price', e.target.value.replace(/[^0-9]/g, '')),
                        placeholder: 'ÏßÅÏ†ë ÏûÖÎ†•',
                        style: {
                          width: '100%',
                          padding: '0.5rem',
                          border: '1px solid #cbd5e1',
                          borderRadius: '6px',
                          fontSize: '0.9rem'
                        }
                      })
                    ),

                    // ÏÉÅÌíà URL
                    React.createElement('div', null,
                      React.createElement('label', {
                        style: {
                          display: 'block',
                          fontSize: '0.8rem',
                          fontWeight: '500',
                          color: '#475569',
                          marginBottom: '0.5rem'
                        }
                      }, 'ÏÉÅÌíà URL (ÏÑ†ÌÉù)'),
                      React.createElement('input', {
                        type: 'text',
                        value: order.productUrl || '',
                        onChange: (e) => updateOrder(index, 'productUrl', e.target.value),
                        placeholder: 'https://...',
                        style: {
                          width: '100%',
                          padding: '0.5rem',
                          border: '1px solid #cbd5e1',
                          borderRadius: '6px',
                          fontSize: '0.9rem'
                        }
                      })
                    )
                  )
                ),

                // Ï£ºÎ¨∏Ïûê ÏÑ§Ï†ï
                React.createElement('div', {
                  style: {
                    display: 'grid',
                    gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))',
                    gap: '1rem'
                  }
                },
                  // Ï£ºÎ¨∏Ïûê
                  React.createElement('div', null,
                    React.createElement('label', {
                      style: {
                        display: 'block',
                        fontSize: '0.8rem',
                        fontWeight: '500',
                        color: '#475569',
                        marginBottom: '0.5rem'
                      }
                    }, 'Ï£ºÎ¨∏Ïûê'),
                    React.createElement('select', {
                      value: order.person,
                      onChange: (e) => updateOrder(index, 'person', e.target.value),
                      style: {
                        width: '100%',
                        padding: '0.5rem',
                        border: '1px solid #cbd5e1',
                        borderRadius: '6px',
                        fontSize: '0.9rem'
                      }
                    }, Object.keys(PRESETS).map(name =>
                      React.createElement('option', { key: name, value: name }, name)
                    ))
                  ),

                  // ID
                  React.createElement('div', null,
                    React.createElement('label', {
                      style: {
                        display: 'block',
                        fontSize: '0.8rem',
                        fontWeight: '500',
                        color: '#475569',
                        marginBottom: '0.5rem'
                      }
                    }, 'ID'),
                    React.createElement('select', {
                      value: order.personId,
                      onChange: (e) => updateOrder(index, 'personId', e.target.value),
                      style: {
                        width: '100%',
                        padding: '0.5rem',
                        border: '1px solid #cbd5e1',
                        borderRadius: '6px',
                        fontSize: '0.9rem'
                      }
                    }, 
                      // Îç∞Ïù¥ÌÑ∞ ÌÖåÏù¥Î∏îÏùò ÏÇ¨Ïù¥Ìä∏ Ï†ïÎ≥¥Î°ú ÏïÑÏù¥Îîî Î™©Î°ù Í≤∞Ï†ï
                      (() => {
                        const selectedSite = selectedOrders.length > 0 ? editableData[selectedOrders[0]]?.site : '';
                        const currentSiteIds = SITE_IDS[selectedSite] || IDS || ['ÏßÅÏ†ëÏûÖÎ†•'];
                        console.log('ÏÑ†ÌÉùÎêú ÏÇ¨Ïù¥Ìä∏:', selectedSite, 'ÏïÑÏù¥Îîî Î™©Î°ù:', currentSiteIds);
                        return currentSiteIds.map(id => 
                          React.createElement('option', { key: id, value: id }, id)
                        );
                      })()
                    )
                  ),

                  // ID ÏßÅÏ†ëÏûÖÎ†• Ïπ∏
                  order.personId === 'ÏßÅÏ†ëÏûÖÎ†•' && React.createElement('div', null,
                    React.createElement('label', {
                      style: {
                        display: 'block',
                        fontSize: '0.8rem',
                        fontWeight: '500',
                        color: '#475569',
                        marginBottom: '0.5rem'
                      }
                    }, 'ID ÏûÖÎ†•'),
                    React.createElement('input', {
                      type: 'text',
                      value: order.customId || '',
                      onChange: (e) => updateOrder(index, 'customId', e.target.value),
                      placeholder: 'IDÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî',
                      style: {
                        width: '100%',
                        padding: '0.5rem',
                        border: '2px solid #3b82f6',
                        borderRadius: '6px',
                        fontSize: '0.9rem'
                      }
                    })
                  ),

                  // Ïπ¥Îìú
                  React.createElement('div', null,
                    React.createElement('label', {
                      style: {
                        display: 'block',
                        fontSize: '0.8rem',
                        fontWeight: '500',
                        color: '#475569',
                        marginBottom: '0.5rem'
                      }
                    }, 'Ïπ¥Îìú'),
                    React.createElement('select', {
                      value: order.card,
                      onChange: (e) => updateOrder(index, 'card', e.target.value),
                      style: {
                        width: '100%',
                        padding: '0.5rem',
                        border: '1px solid #cbd5e1',
                        borderRadius: '6px',
                        fontSize: '0.9rem'
                      }
                    }, CARDS.map(card =>
                      React.createElement('option', { key: card, value: card }, card)
                    ))
                  ),

                  // Î∞∞ÏÜ°
                  React.createElement('div', null,
                    React.createElement('label', {
                      style: {
                        display: 'block',
                        fontSize: '0.8rem',
                        fontWeight: '500',
                        color: '#475569',
                        marginBottom: '0.5rem'
                      }
                    }, 'Î∞∞ÏÜ°'),
                    React.createElement('select', {
                      value: order.deliveryType,
                      onChange: (e) => updateOrder(index, 'deliveryType', e.target.value),
                      style: {
                        width: '100%',
                        padding: '0.5rem',
                        border: '1px solid #cbd5e1',
                        borderRadius: '6px',
                        fontSize: '0.9rem'
                      }
                    }, DELIVERY_TYPES.map(type =>
                      React.createElement('option', { key: type, value: type }, type)
                    ))
                  ),

                  // Î¶¨Î∑∞
                  React.createElement('div', null,
                    React.createElement('label', {
                      style: {
                        display: 'block',
                        fontSize: '0.8rem',
                        fontWeight: '500',
                        color: '#475569',
                        marginBottom: '0.5rem'
                      }
                    }, 'Î¶¨Î∑∞'),
                    React.createElement('select', {
                      value: order.reviewMethod,
                      onChange: (e) => updateOrder(index, 'reviewMethod', e.target.value),
                      style: {
                        width: '100%',
                        padding: '0.5rem',
                        border: '1px solid #cbd5e1',
                        borderRadius: '6px',
                        fontSize: '0.9rem'
                      }
                    }, REVIEW_METHODS.map(method =>
                      React.createElement('option', { key: method, value: method }, method)
                    ))
                  ),

                  // Î¶ΩÎπÑ
                  React.createElement('div', null,
                    React.createElement('label', {
                      style: {
                        display: 'block',
                        fontSize: '0.8rem',
                        fontWeight: '500',
                        color: '#475569',
                        marginBottom: '0.5rem'
                      }
                    }, 'Î¶ΩÎπÑ'),
                    React.createElement('select', {
                      value: order.reviewFee,
                      onChange: (e) => updateOrder(index, 'reviewFee', e.target.value),
                      style: {
                        width: '100%',
                        padding: '0.5rem',
                        border: '1px solid #cbd5e1',
                        borderRadius: '6px',
                        fontSize: '0.9rem'
                      }
                    }, REVIEW_FEES.map(fee =>
                      React.createElement('option', { key: fee, value: fee }, fee)
                    ))
                  ),

                  // Î¶ΩÎπÑ ÏßÅÏ†ëÏûÖÎ†•
                  order.reviewFee === 'ÏßÅÏ†ëÏûÖÎ†•' && React.createElement('div', null,
                    React.createElement('input', {
                      type: 'text',
                      value: order.customFee || '',
                      onChange: (e) => updateOrder(index, 'customFee', e.target.value.replace(/[^0-9]/g, '')),
                      placeholder: 'Í∏àÏï° ÏûÖÎ†• (Ïà´ÏûêÎßå)',
                      style: {
                        width: '100%',
                        padding: '0.5rem',
                        border: '2px solid #3b82f6',
                        borderRadius: '6px',
                        fontSize: '0.9rem',
                        marginTop: '0.5rem'
                      }
                    })
                  )
                ),

                // Í∞ÄÏù¥ÎìúÎùºÏù∏
                React.createElement('div', { style: { marginTop: '1rem' } },
                  React.createElement('label', {
                    style: {
                      display: 'block',
                      fontSize: '0.8rem',
                      fontWeight: '500',
                      color: '#475569',
                      marginBottom: '0.5rem'
                    }
                  }, 'Í∞ÄÏù¥ÎìúÎùºÏù∏'),
                  React.createElement('textarea', {
                    value: order.guideline,
                    onChange: (e) => updateOrder(index, 'guideline', e.target.value),
                    placeholder: 'ÌåêÎß§Ïûê Í∞ÄÏù¥ÎìúÎùºÏù∏ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî...',
                    style: {
                      width: '100%',
                      minHeight: '60px',
                      padding: '0.5rem',
                      border: '1px solid #cbd5e1',
                      borderRadius: '6px',
                      fontSize: '0.9rem',
                      fontFamily: 'inherit',
                      resize: 'vertical'
                    }
                  })
                )
              )
            )),

            // Í≥µÌÜµ ÏÑ§Ï†ï
            React.createElement('div', {
              style: {
                background: '#f8fafc',
                border: '2px solid #e2e8f0',
                borderRadius: '12px',
                padding: '1.5rem',
                marginBottom: '1.5rem'
              }
            },
              React.createElement('h2', {
                style: {
                  fontSize: '1.3rem',
                  fontWeight: '600',
                  marginBottom: '1rem',
                  color: '#2d3748'
                }
              }, 'üí≥ Í≥µÌÜµ ÏÑ§Ï†ï'),

              React.createElement('div', {
                style: {
                  display: 'grid',
                  gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',
                  gap: '1rem',
                  marginBottom: '1rem'
                }
              },
                // Ï£ºÎ¨∏Ïûê
                React.createElement('div', null,
                  React.createElement('label', {
                    style: {
                      display: 'block',
                      fontSize: '0.85rem',
                      fontWeight: '500',
                      color: '#475569',
                      marginBottom: '0.5rem'
                    }
                  }, 'Ï£ºÎ¨∏Ïûê (ÏùºÍ¥Ñ Ï†ÅÏö©)'),
                  React.createElement('select', {
                    value: commonSettings.person || '',
                    onChange: (e) => setCommonSettings({...commonSettings, person: e.target.value}),
                    style: {
                      width: '100%',
                      padding: '0.5rem',
                      border: '1px solid #cbd5e1',
                      borderRadius: '6px',
                      fontSize: '0.9rem'
                    }
                  }, 
                    React.createElement('option', { value: '' }, 'ÏÑ†ÌÉù ÏïàÌï® (ÏûêÎèô)'),
                    Object.keys(PRESETS).map(name =>
                      React.createElement('option', { key: name, value: name }, name)
                    )
                  )
                ),

                // Í±∞ÎûòÏùºÏûê
                React.createElement('div', null,
                  React.createElement('label', {
                    style: {
                      display: 'block',
                      fontSize: '0.85rem',
                      fontWeight: '500',
                      color: '#475569',
                      marginBottom: '0.5rem'
                    }
                  }, 'Í±∞ÎûòÏùºÏûê'),
                  React.createElement('input', {
                    type: 'date',
                    value: commonSettings.transactionDate,
                    onChange: (e) => setCommonSettings({...commonSettings, transactionDate: e.target.value}),
                    style: {
                      width: '100%',
                      padding: '0.5rem',
                      border: '1px solid #cbd5e1',
                      borderRadius: '6px',
                      fontSize: '0.9rem'
                    }
                  })
                ),

                // ÌÜ°Î∞©Ïù¥Î¶Ñ
                React.createElement('div', null,
                  React.createElement('label', {
                    style: {
                      display: 'block',
                      fontSize: '0.85rem',
                      fontWeight: '500',
                      color: '#475569',
                      marginBottom: '0.5rem'
                    }
                  }, 'ÌÜ°Î∞©Ïù¥Î¶Ñ'),
                  React.createElement('input', {
                    type: 'text',
                    value: commonSettings.talkRoomName,
                    onChange: (e) => setCommonSettings({...commonSettings, talkRoomName: e.target.value}),
                    placeholder: 'Ïòà: AD Î∞©Î™Ö',
                    style: {
                      width: '100%',
                      padding: '0.5rem',
                      border: '1px solid #cbd5e1',
                      borderRadius: '6px',
                      fontSize: '0.9rem'
                    }
                  })
                ),

                // Î∞∞ÏÜ°ÌòïÌÉú
                React.createElement('div', null,
                  React.createElement('label', {
                    style: {
                      display: 'block',
                      fontSize: '0.85rem',
                      fontWeight: '500',
                      color: '#475569',
                      marginBottom: '0.5rem'
                    }
                  }, 'Î∞∞ÏÜ°ÌòïÌÉú'),
                  React.createElement('select', {
                    value: commonSettings.deliveryType,
                    onChange: (e) => setCommonSettings({...commonSettings, deliveryType: e.target.value}),
                    style: {
                      width: '100%',
                      padding: '0.5rem',
                      border: '1px solid #cbd5e1',
                      borderRadius: '6px',
                      fontSize: '0.9rem'
                    }
                  }, DELIVERY_TYPES.map(type =>
                    React.createElement('option', { key: type, value: type }, type)
                  ))
                ),

                // Î¶¨Î∑∞Î∞©Î≤ï
                React.createElement('div', null,
                  React.createElement('label', {
                    style: {
                      display: 'block',
                      fontSize: '0.85rem',
                      fontWeight: '500',
                      color: '#475569',
                      marginBottom: '0.5rem'
                    }
                  }, 'Î¶¨Î∑∞Î∞©Î≤ï'),
                  React.createElement('select', {
                    value: commonSettings.reviewMethod,
                    onChange: (e) => setCommonSettings({...commonSettings, reviewMethod: e.target.value}),
                    style: {
                      width: '100%',
                      padding: '0.5rem',
                      border: '1px solid #cbd5e1',
                      borderRadius: '6px',
                      fontSize: '0.9rem'
                    }
                  }, REVIEW_METHODS.map(method =>
                    React.createElement('option', { key: method, value: method }, method)
                  ))
                ),

                // Î¶ΩÎπÑ
                React.createElement('div', null,
                  React.createElement('label', {
                    style: {
                      display: 'block',
                      fontSize: '0.85rem',
                      fontWeight: '500',
                      color: '#475569',
                      marginBottom: '0.5rem'
                    }
                  }, 'Î¶ΩÎπÑ'),
                  React.createElement('select', {
                    value: commonSettings.reviewFee,
                    onChange: (e) => setCommonSettings({...commonSettings, reviewFee: e.target.value}),
                    style: {
                      width: '100%',
                      padding: '0.5rem',
                      border: '1px solid #cbd5e1',
                      borderRadius: '6px',
                      fontSize: '0.9rem'
                    }
                  }, REVIEW_FEES.map(fee =>
                    React.createElement('option', { key: fee, value: fee }, fee)
                  ))
                ),

                // Î¶ΩÎπÑ ÏßÅÏ†ëÏûÖÎ†•
                commonSettings.reviewFee === 'ÏßÅÏ†ëÏûÖÎ†•' && React.createElement('div', null,
                  React.createElement('label', {
                    style: {
                      display: 'block',
                      fontSize: '0.85rem',
                      fontWeight: '500',
                      color: '#475569',
                      marginBottom: '0.5rem'
                    }
                  }, 'Î¶ΩÎπÑ Í∏àÏï°'),
                  React.createElement('input', {
                    type: 'text',
                    value: commonSettings.customReviewFee || '',
                    onChange: (e) => setCommonSettings({...commonSettings, customReviewFee: e.target.value.replace(/[^0-9]/g, '')}),
                    placeholder: 'Í∏àÏï° ÏûÖÎ†•',
                    style: {
                      width: '100%',
                      padding: '0.5rem',
                      border: '2px solid #3b82f6',
                      borderRadius: '6px',
                      fontSize: '0.9rem'
                    }
                  })
                )
              ),

              // Í∞ÄÏù¥ÎìúÎùºÏù∏ ÏùºÍ¥ÑÏûÖÎ†•
              React.createElement('div', { style: { marginBottom: '1rem' } },
                React.createElement('label', {
                  style: {
                    display: 'block',
                    fontSize: '0.85rem',
                    fontWeight: '500',
                    color: '#475569',
                    marginBottom: '0.5rem'
                  }
                }, 'Í∞ÄÏù¥ÎìúÎùºÏù∏ ÏùºÍ¥ÑÏûÖÎ†•'),
                React.createElement('textarea', {
                  value: commonSettings.guideline,
                  onChange: (e) => setCommonSettings({...commonSettings, guideline: e.target.value}),
                  placeholder: 'Î™®Îì† Ï£ºÎ¨∏Ïóê Ï†ÅÏö©Ìï† Í∞ÄÏù¥ÎìúÎùºÏù∏...',
                  style: {
                    width: '100%',
                    minHeight: '60px',
                    padding: '0.5rem',
                    border: '1px solid #cbd5e1',
                    borderRadius: '6px',
                    fontSize: '0.9rem',
                    fontFamily: 'inherit',
                    resize: 'vertical'
                  }
                })
              ),

              React.createElement('button', {
                onClick: applyCommonSettings,
                style: {
                  background: '#10b981',
                  color: 'white',
                  border: 'none',
                  padding: '0.75rem 1.5rem',
                  borderRadius: '8px',
                  fontSize: '0.95rem',
                  fontWeight: '600',
                  cursor: 'pointer'
                }
              }, '‚ö° Í≥µÌÜµÏÑ§Ï†ï Î™®Îì† Ï£ºÎ¨∏Ïóê Ï†ÅÏö©')
            ),

            // Ï∂úÎ†• ÏÑ§Ï†ï (ÏÉà Î≤ÑÏ†Ñ)
            React.createElement('div', {
              style: {
                background: '#f8fafc',
                border: '2px solid #e2e8f0',
                borderRadius: '12px',
                padding: '1.5rem',
                marginBottom: '1.5rem'
              }
            },
              React.createElement('h2', {
                style: {
                  fontSize: '1.3rem',
                  fontWeight: '600',
                  marginBottom: '1rem',
                  color: '#2d3748'
                }
              }, 'üìã Ï∂úÎ†• ÏÑ§Ï†ï'),

              // 1. Ìèº ÏñëÏãù ÏûÖÎ†•
              React.createElement('div', { style: { marginBottom: '1.5rem' } },
                React.createElement('label', {
                  style: {
                    display: 'block',
                    fontSize: '0.95rem',
                    fontWeight: '600',
                    color: '#475569',
                    marginBottom: '0.5rem'
                  }
                }, '1. Ìèº ÏñëÏãù ÏûÖÎ†•'),
                React.createElement('div', {
                  style: {
                    display: 'flex',
                    justifyContent: 'space-between',
                    alignItems: 'center',
                    marginBottom: '0.5rem'
                  }
                },
                  React.createElement('div'),
                  Object.keys(learnedMappings).length > 0 && React.createElement('button', {
                    onClick: () => {
                      if (confirm(`ÌïôÏäµÎêú ${Object.keys(learnedMappings).length}Í∞ú Îß§ÌïëÏùÑ Î™®Îëê ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?`)) {
                        setLearnedMappings({});
                        localStorage.removeItem('learnedMappings');
                        alert('‚úÖ ÌïôÏäµ Îç∞Ïù¥ÌÑ∞Í∞Ä Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§');
                      }
                    },
                    style: {
                      fontSize: '0.75rem',
                      padding: '0.25rem 0.5rem',
                      background: '#fef2f2',
                      border: '1px solid #fca5a5',
                      borderRadius: '4px',
                      color: '#991b1b',
                      cursor: 'pointer'
                    }
                  }, `üìö ÌïôÏäµÎêú Îß§Ìïë ${Object.keys(learnedMappings).length}Í∞ú`)
                ),
                React.createElement('textarea', {
                  value: formTemplate,
                  onChange: (e) => setFormTemplate(e.target.value),
                  placeholder: `Ìèº ÏñëÏãùÏùÑ Î∂ôÏó¨ÎÑ£ÏúºÏÑ∏Ïöî:

ÏòàÏãú 1 (ÎùºÎ≤®):
Ïù¥Î¶Ñ:
Ï£ºÎ¨∏Î≤àÌò∏:
ÏïÑÏù¥Îîî:

ÏòàÏãú 2 (Ïä¨ÎûòÏãú):
Ïù¥Î¶Ñ / Ï†ÑÌôîÎ≤àÌò∏ / Ï£ºÏÜå`,
                  style: {
                    width: '100%',
                    minHeight: '120px',
                    padding: '0.75rem',
                    border: '1px solid #cbd5e1',
                    borderRadius: '8px',
                    fontSize: '0.9rem',
                    fontFamily: 'monospace',
                    resize: 'vertical'
                  }
                }),
                React.createElement('div', {
                  style: {
                    marginTop: '0.5rem',
                    display: 'flex',
                    alignItems: 'center',
                    gap: '0.5rem'
                  }
                },
                  React.createElement('input', {
                    type: 'checkbox',
                    checked: removeLabels,
                    onChange: (e) => setRemoveLabels(e.target.checked),
                    style: { cursor: 'pointer' }
                  }),
                  React.createElement('label', {
                    style: {
                      fontSize: '0.9rem',
                      color: '#475569',
                      cursor: 'pointer'
                    },
                    onClick: () => setRemoveLabels(!removeLabels)
                  }, 'ÎùºÎ≤® Ï†úÍ±∞ (Í∞íÎßå Ï∂úÎ†•)')
                )
              ),

              // 2. Ï£ºÎ¨∏ ÏÑ†ÌÉù
              React.createElement('div', { style: { marginBottom: '1.5rem' } },
                React.createElement('label', {
                  style: {
                    display: 'block',
                    fontSize: '0.95rem',
                    fontWeight: '600',
                    color: '#475569',
                    marginBottom: '0.75rem'
                  }
                }, `2. Ï∂úÎ†•Ìï† Ï£ºÎ¨∏ ÏÑ†ÌÉù (${selectedOrders.length}/${orders.length})`),
                React.createElement('div', {
                  style: {
                    display: 'flex',
                    gap: '1rem',
                    flexWrap: 'wrap'
                  }
                }, orders.map((order, index) =>
                  React.createElement('div', {
                    key: order.id,
                    style: {
                      display: 'flex',
                      alignItems: 'center',
                      gap: '0.5rem',
                      padding: '0.75rem',
                      background: selectedOrders.includes(index) ? '#dbeafe' : 'white',
                      border: `2px solid ${selectedOrders.includes(index) ? '#3b82f6' : '#e2e8f0'}`,
                      borderRadius: '8px',
                      cursor: 'pointer',
                      transition: 'all 0.2s'
                    },
                    onClick: () => toggleOrderSelection(index)
                  },
                    React.createElement('input', {
                      type: 'checkbox',
                      checked: selectedOrders.includes(index),
                      onChange: () => {},
                      style: { cursor: 'pointer' }
                    }),
                    React.createElement('div', {
                      style: {
                        fontSize: '0.9rem',
                        fontWeight: '500',
                        color: '#1e293b'
                      }
                    }, `Ï£ºÎ¨∏ ${index + 1}`),
                    React.createElement('div', {
                      style: {
                        fontSize: '0.8rem',
                        color: '#64748b'
                      }
                    }, `(${PRESETS[order.person]?.name || 'ÎØ∏ÏÑ§Ï†ï'})`)
                  )
                )),
                React.createElement('button', {
                  onClick: () => setSelectedOrders(orders.map((_, i) => i)),
                  style: {
                    marginTop: '0.5rem',
                    padding: '0.5rem 1rem',
                    background: '#f1f5f9',
                    border: '1px solid #cbd5e1',
                    borderRadius: '6px',
                    fontSize: '0.85rem',
                    cursor: 'pointer'
                  }
                }, 'Ï†ÑÏ≤¥ ÏÑ†ÌÉù')
              ),

              // 3. Îç∞Ïù¥ÌÑ∞ Ìé∏Ïßë ÌÖåÏù¥Î∏î
              selectedOrders.length > 0 && formTemplate && React.createElement('div', { 
                style: { 
                  marginBottom: '1.5rem',
                  marginTop: '1.5rem'
                } 
              },
                React.createElement('label', {
                  style: {
                    display: 'block',
                    fontSize: '0.95rem',
                    fontWeight: '600',
                    color: '#475569',
                    marginBottom: '0.75rem'
                  }
                }, '3. Îç∞Ïù¥ÌÑ∞ Ìé∏Ïßë'),
                React.createElement('div', {
                  style: {
                    overflowX: 'auto',
                    background: 'white',
                    border: '1px solid #e2e8f0',
                    borderRadius: '8px',
                    padding: '1rem'
                  }
                },
                  parseFormTemplate(formTemplate).map(field => {
                    const key = mapFieldToKey(field);
                    const isUnknown = key === field; // Îß§ÌïëÏùÑ Î™®Î•¥Îäî Í≤ΩÏö∞
                    
                    return React.createElement('div', {
                      key: field,
                      style: {
                        display: 'flex',
                        alignItems: 'center',
                        gap: '1rem',
                        marginBottom: '0.75rem',
                        paddingBottom: '0.75rem',
                        borderBottom: '1px solid #f1f5f9'
                      }
                    },
                      // ÎùºÎ≤®Î™Ö
                      React.createElement('div', {
                        style: {
                          minWidth: '120px',
                          display: 'flex',
                          flexDirection: 'column',
                          gap: '0.25rem'
                        }
                      },
                        React.createElement('div', {
                          style: {
                            fontWeight: '500',
                            fontSize: '0.9rem',
                            color: isUnknown ? '#ef4444' : '#475569'
                          }
                        }, field),
                        
                        // Ïïå Ïàò ÏóÜÎäî ÎùºÎ≤®Ïùº Í≤ΩÏö∞ ÌïôÏäµ ÏòµÏÖò ÌëúÏãú
                        isUnknown && React.createElement('select', {
                          onChange: (e) => {
                            if (e.target.value) {
                              saveLearnedMapping(field, e.target.value);
                            }
                          },
                          style: {
                            fontSize: '0.75rem',
                            padding: '0.25rem',
                            border: '1px solid #fca5a5',
                            borderRadius: '4px',
                            background: '#fef2f2',
                            color: '#991b1b',
                            cursor: 'pointer'
                          }
                        },
                          React.createElement('option', { value: '' }, 'Ìï≠Î™© ÏÑ†ÌÉù'),
                          React.createElement('option', { value: 'name' }, 'Ïù¥Î¶Ñ'),
                          React.createElement('option', { value: 'receiver' }, 'ÏàòÏ∑®Ïù∏'),
                          React.createElement('option', { value: 'orderNumber' }, 'Ï£ºÎ¨∏Î≤àÌò∏'),
                          React.createElement('option', { value: 'personId' }, 'ÏïÑÏù¥Îîî'),
                          React.createElement('option', { value: 'phone' }, 'Ï†ÑÌôîÎ≤àÌò∏'),
                          React.createElement('option', { value: 'phoneNoHyphen' }, 'Ï†ÑÌôîÎ≤àÌò∏(ÌïòÏù¥ÌîàÏóÜÏùå)'),
                          React.createElement('option', { value: 'address' }, 'Ï£ºÏÜå'),
                          React.createElement('option', { value: 'price' }, 'Í∏àÏï°'),
                          React.createElement('option', { value: 'site' }, 'ÏÇ¨Ïù¥Ìä∏'),
                          React.createElement('option', { value: 'card' }, 'Ïπ¥Îìú'),
                          React.createElement('option', { value: 'bank' }, 'ÏùÄÌñâ'),
                          React.createElement('option', { value: 'accountWithHyphen' }, 'Í≥ÑÏ¢åÎ≤àÌò∏'),
                          React.createElement('option', { value: 'account' }, 'Í≥ÑÏ¢åÎ≤àÌò∏(ÌïòÏù¥ÌîàÏóÜÏùå)'),
                          React.createElement('option', { value: 'deliveryType' }, 'Î∞∞ÏÜ°'),
                          React.createElement('option', { value: 'reviewMethod' }, 'Î¶¨Î∑∞'),
                          React.createElement('option', { value: 'reviewFee' }, 'Î¶ΩÎπÑ')
                        )
                      ),
                      
                      // ÏûÖÎ†• Ïπ∏Îì§
                      React.createElement('div', {
                        style: {
                          display: 'flex',
                          gap: '0.5rem',
                          flex: 1,
                          flexWrap: 'wrap'
                        }
                      }, selectedOrders.map(orderIndex => {
                        // ÏïÑÏù¥Îîî ÌïÑÎìúÎäî ÎìúÎ°≠Îã§Ïö¥ÏúºÎ°ú
                        if (key === 'personId') {
                          const selectedSite = editableData[orderIndex]?.site || '';
                          const currentSiteIds = SITE_IDS[selectedSite] || IDS || ['ÏßÅÏ†ëÏûÖÎ†•'];
                          
                          return React.createElement('select', {
                            key: orderIndex,
                            value: editableData[orderIndex]?.[key] || '',
                            onChange: (e) => updateEditableData(orderIndex, key, e.target.value),
                            style: {
                              flex: '1 1 200px',
                              padding: '0.5rem',
                              border: '1px solid #cbd5e1',
                              borderRadius: '6px',
                              fontSize: '0.85rem',
                              cursor: 'pointer'
                            }
                          },
                            currentSiteIds.map(id => 
                              React.createElement('option', { key: id, value: id }, id)
                            )
                          );
                        }
                        
                        // ÎÇòÎ®∏ÏßÄ ÌïÑÎìúÎäî ÌÖçÏä§Ìä∏ ÏûÖÎ†•
                        return React.createElement('input', {
                          key: orderIndex,
                          type: 'text',
                          value: editableData[orderIndex]?.[key] || '',
                          onChange: (e) => updateEditableData(orderIndex, key, e.target.value),
                          placeholder: `Ï£ºÎ¨∏${orderIndex + 1}`,
                          style: {
                            flex: '1 1 200px',
                            padding: '0.5rem',
                            border: '1px solid #cbd5e1',
                            borderRadius: '6px',
                            fontSize: '0.85rem'
                          }
                        });
                      }))
                    );
                  })
                )
              ),

              // 4. Î≥µÏÇ¨ Î≤ÑÌäº
              React.createElement('div', {
                style: {
                  display: 'flex',
                  justifyContent: 'center'
                }
              },
                React.createElement('button', {
                  onClick: copyOutputToClipboard,
                  style: {
                    background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                    color: 'white',
                    border: 'none',
                    padding: '1rem 2rem',
                    borderRadius: '8px',
                    fontSize: '1rem',
                    fontWeight: '600',
                    cursor: 'pointer',
                    boxShadow: '0 4px 12px rgba(102, 126, 234, 0.4)'
                  }
                }, 'üìã Î≥µÏÇ¨ÌïòÍ∏∞')
              )
            ),

            // Ï†ÄÏû• / Ï¥àÍ∏∞Ìôî Î≤ÑÌäº
            React.createElement('div', {
              style: {
                marginBottom: '1.5rem'
              }
            },
              React.createElement('h2', {
                style: {
                  fontSize: '1.3rem',
                  fontWeight: '600',
                  marginBottom: '1rem',
                  color: '#2d3748'
                }
              }, 'üíæ Îç∞Ïù¥ÌÑ∞ Í¥ÄÎ¶¨'),
              
              React.createElement('div', {
                style: {
                  display: 'flex',
                  gap: '1rem',
                  justifyContent: 'center'
                }
              },
                React.createElement('button', {
                  onClick: saveToGoogleSheets,
                  style: {
                    background: '#10b981',
                    color: 'white',
                    border: 'none',
                    padding: '1rem 2rem',
                    borderRadius: '8px',
                    fontSize: '1rem',
                    fontWeight: '600',
                    cursor: 'pointer',
                    boxShadow: '0 4px 12px rgba(16, 185, 129, 0.4)'
                  }
                }, 'üíæ Íµ¨Í∏ÄÏãúÌä∏ Ï†ÄÏû•'),

                React.createElement('button', {
                  onClick: resetAllOrders,
                  style: {
                    background: '#ef4444',
                    color: 'white',
                    border: 'none',
                    padding: '1rem 2rem',
                    borderRadius: '8px',
                    fontSize: '1rem',
                    fontWeight: '600',
                    cursor: 'pointer',
                    boxShadow: '0 4px 12px rgba(239, 68, 68, 0.4)'
                  }
                }, 'üóëÔ∏è Ï†ÑÏ≤¥ Ï¥àÍ∏∞Ìôî')
              )
            )
          )
        )
      );
    };

    ReactDOM.render(
      React.createElement(OrderManager),
      document.getElementById('root')
    );
  </script>
</body>
</html>
